<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Supply Chain Dependency Audit Report</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@400;500;600;700&family=DM+Sans:wght@300;400;500;600&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg-primary:#070b14;--bg-secondary:#0d1321;--bg-card:#111828;--bg-card-hover:#172036;
  --border:#1e293b;--border-bright:#2d3f5e;
  --text-primary:#e2e8f0;--text-secondary:#94a3b8;--text-muted:#64748b;
  --accent:#22d3a7;--accent-dim:rgba(34,211,167,.12);--accent-glow:rgba(34,211,167,.25);
  --critical:#ef476f;--critical-dim:rgba(239,71,111,.12);
  --high:#f77f00;--high-dim:rgba(247,127,0,.12);
  --medium:#ffd166;--medium-dim:rgba(255,209,102,.12);
  --low:#118ab2;--low-dim:rgba(17,138,178,.12);
  --none:#4a5568;
  --font-display:'Chakra Petch',sans-serif;--font-body:'DM Sans',sans-serif;--font-mono:'Fira Code',monospace;
  --radius:8px;--radius-lg:12px;
}
html{scroll-behavior:smooth}
body{font-family:var(--font-body);background:var(--bg-primary);color:var(--text-primary);line-height:1.6;min-height:100vh;overflow-x:hidden}
body::before{content:'';position:fixed;inset:0;background:radial-gradient(ellipse at 20% 0%,rgba(34,211,167,.04) 0%,transparent 60%),radial-gradient(ellipse at 80% 100%,rgba(17,138,178,.03) 0%,transparent 60%);pointer-events:none;z-index:0}

.wrapper{max-width:1380px;margin:0 auto;padding:0 24px;position:relative;z-index:1}

header{padding:40px 0 20px;border-bottom:1px solid var(--border)}
.header-inner{display:flex;align-items:flex-end;justify-content:space-between;flex-wrap:wrap;gap:16px}
.brand{display:flex;align-items:center;gap:14px}
.brand-icon{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#118ab2);display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:700;color:var(--bg-primary);font-family:var(--font-display)}
h1{font-family:var(--font-display);font-size:1.65rem;font-weight:700;letter-spacing:0.5px;color:var(--text-primary)}
.header-sub{font-size:.82rem;color:var(--text-muted);margin-top:2px}
.header-meta{text-align:right;font-size:.78rem;color:var(--text-muted);line-height:1.8}
.header-meta span{color:var(--text-secondary)}

.section{padding:32px 0}
.section-title{font-family:var(--font-display);font-size:1.1rem;font-weight:600;letter-spacing:0.4px;color:var(--text-primary);margin-bottom:18px;display:flex;align-items:center;gap:10px}
.section-title::before{content:'';width:3px;height:20px;background:var(--accent);border-radius:2px}

.kpi-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(190px,1fr));gap:14px;margin-bottom:28px}
.kpi{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius-lg);padding:22px;position:relative;overflow:hidden;transition:border-color .2s}
.kpi:hover{border-color:var(--border-bright)}
.kpi-label{font-size:.72rem;text-transform:uppercase;letter-spacing:1.2px;color:var(--text-muted);font-weight:500;margin-bottom:8px}
.kpi-value{font-family:var(--font-display);font-size:2rem;font-weight:700;line-height:1}
.kpi-sub{font-size:.75rem;color:var(--text-muted);margin-top:6px}
.kpi-stripe{position:absolute;top:0;left:0;right:0;height:3px}
.kpi--accent .kpi-value{color:var(--accent)}.kpi--accent .kpi-stripe{background:var(--accent)}
.kpi--critical .kpi-value{color:var(--critical)}.kpi--critical .kpi-stripe{background:var(--critical)}
.kpi--high .kpi-value{color:var(--high)}.kpi--high .kpi-stripe{background:var(--high)}
.kpi--medium .kpi-value{color:var(--medium)}.kpi--medium .kpi-stripe{background:var(--medium)}
.kpi--low .kpi-value{color:var(--low)}.kpi--low .kpi-stripe{background:var(--low)}
.kpi--neutral .kpi-value{color:var(--text-secondary)}.kpi--neutral .kpi-stripe{background:var(--text-muted)}

.risk-gauge{display:flex;align-items:center;gap:28px;background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius-lg);padding:28px 32px;margin-bottom:28px}
.gauge-visual{flex-shrink:0}
.gauge-info h3{font-family:var(--font-display);font-size:1.5rem;font-weight:700;margin-bottom:4px}
.gauge-info p{color:var(--text-secondary);font-size:.88rem;max-width:500px;line-height:1.7}

.chart-row{display:grid;grid-template-columns:1fr 1fr;gap:18px;margin-bottom:28px}
@media(max-width:860px){.chart-row{grid-template-columns:1fr}}
.chart-card{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius-lg);padding:24px}
.chart-card h3{font-family:var(--font-display);font-size:.88rem;font-weight:600;margin-bottom:16px;color:var(--text-secondary)}

.severity-bars{display:flex;flex-direction:column;gap:10px}
.sev-row{display:flex;align-items:center;gap:12px}
.sev-label{width:70px;font-size:.75rem;font-weight:500;text-transform:uppercase;letter-spacing:.5px}
.sev-bar-track{flex:1;height:24px;background:var(--bg-secondary);border-radius:4px;overflow:hidden}
.sev-bar-fill{height:100%;border-radius:4px;transition:width .8s ease}
.sev-count{font-family:var(--font-mono);font-size:.82rem;width:36px;text-align:right;font-weight:500}

.donut-wrap{display:flex;align-items:center;justify-content:center;gap:30px;min-height:200px}
.donut-legend{display:flex;flex-direction:column;gap:8px}
.legend-item{display:flex;align-items:center;gap:8px;font-size:.8rem;color:var(--text-secondary)}
.legend-dot{width:10px;height:10px;border-radius:50%;flex-shrink:0}

.tree-container{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius-lg);padding:20px;margin-bottom:28px;overflow:hidden}
.tree-container h3{font-family:var(--font-display);font-size:.88rem;font-weight:600;margin-bottom:14px;color:var(--text-secondary)}
#dep-tree{width:100%;overflow-x:auto}
#dep-tree svg{display:block;margin:0 auto}
.tree-node circle{stroke-width:2px;cursor:pointer;transition:r .15s}
.tree-node:hover circle{r:7}
.tree-node text{font-family:var(--font-mono);font-size:11px;fill:var(--text-secondary)}
.tree-link{fill:none;stroke:var(--border-bright);stroke-width:1.2px;opacity:.6}

.table-wrap{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius-lg);overflow:hidden;margin-bottom:28px}
.table-toolbar{display:flex;align-items:center;gap:12px;padding:16px 20px;border-bottom:1px solid var(--border);flex-wrap:wrap}
.table-toolbar input{background:var(--bg-secondary);border:1px solid var(--border);border-radius:6px;padding:7px 14px;color:var(--text-primary);font-family:var(--font-body);font-size:.82rem;width:260px;outline:none;transition:border-color .2s}
.table-toolbar input:focus{border-color:var(--accent)}
.table-toolbar input::placeholder{color:var(--text-muted)}
.filter-btn{background:var(--bg-secondary);border:1px solid var(--border);border-radius:6px;padding:6px 14px;color:var(--text-secondary);font-family:var(--font-body);font-size:.78rem;cursor:pointer;transition:all .15s}
.filter-btn:hover,.filter-btn.active{background:var(--accent-dim);border-color:var(--accent);color:var(--accent)}

table{width:100%;border-collapse:collapse}
thead{background:var(--bg-secondary)}
th{font-family:var(--font-display);font-size:.72rem;font-weight:600;text-transform:uppercase;letter-spacing:.8px;color:var(--text-muted);text-align:left;padding:12px 16px;cursor:pointer;user-select:none;white-space:nowrap;transition:color .15s}
th:hover{color:var(--text-primary)}
th .sort-arrow{margin-left:4px;opacity:.4;font-size:.7rem}
th.sorted .sort-arrow{opacity:1;color:var(--accent)}
td{padding:12px 16px;border-top:1px solid var(--border);font-size:.84rem;vertical-align:top}
tr:hover td{background:var(--bg-card-hover)}
.pkg-name{font-family:var(--font-mono);font-weight:500;font-size:.82rem;color:var(--accent)}
.pkg-ver{font-family:var(--font-mono);font-size:.78rem;color:var(--text-muted)}
.badge{display:inline-block;padding:2px 9px;border-radius:4px;font-size:.7rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px}
.badge--critical{background:var(--critical-dim);color:var(--critical)}
.badge--high{background:var(--high-dim);color:var(--high)}
.badge--medium{background:var(--medium-dim);color:var(--medium)}
.badge--low{background:var(--low-dim);color:var(--low)}
.badge--none{background:rgba(74,85,104,.15);color:var(--none)}
.badge--outdated{background:rgba(247,127,0,.1);color:var(--high);margin-left:6px}
.vuln-list{list-style:none;padding:0;margin:4px 0 0}
.vuln-list li{font-size:.78rem;color:var(--text-secondary);padding:3px 0;display:flex;align-items:baseline;gap:6px}
.vuln-id{font-family:var(--font-mono);font-size:.72rem;color:var(--text-muted);white-space:nowrap}
.vuln-src{font-size:.65rem;padding:1px 5px;background:var(--bg-secondary);border-radius:3px;color:var(--text-muted)}
.score-pill{font-family:var(--font-mono);font-size:.8rem;font-weight:600;min-width:36px;display:inline-block;text-align:center}

.vuln-detail-cards{display:grid;grid-template-columns:1fr;gap:14px;margin-bottom:28px}
.vuln-card{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius-lg);padding:20px 24px;border-left:3px solid var(--border)}
.vuln-card--critical{border-left-color:var(--critical)}
.vuln-card--high{border-left-color:var(--high)}
.vuln-card--medium{border-left-color:var(--medium)}
.vuln-card--low{border-left-color:var(--low)}
.vuln-card-header{display:flex;align-items:center;gap:10px;margin-bottom:8px;flex-wrap:wrap}
.vuln-card-id{font-family:var(--font-mono);font-weight:600;font-size:.88rem}
.vuln-card-pkg{font-family:var(--font-mono);font-size:.78rem;color:var(--accent);margin-left:auto}
.vuln-card-body{font-size:.84rem;color:var(--text-secondary);line-height:1.7;margin-bottom:10px}
.vuln-card-meta{display:flex;gap:18px;flex-wrap:wrap;font-size:.75rem;color:var(--text-muted)}
.vuln-card-meta span{display:flex;align-items:center;gap:4px}
a{color:var(--accent);text-decoration:none}a:hover{text-decoration:underline}

.recommendations{background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius-lg);padding:24px 28px;margin-bottom:40px}
.recommendations h3{font-family:var(--font-display);font-size:.92rem;font-weight:600;margin-bottom:16px}
.rec-item{padding:12px 0;border-bottom:1px solid var(--border);display:flex;gap:14px;align-items:flex-start}
.rec-item:last-child{border-bottom:none}
.rec-priority{flex-shrink:0;width:8px;height:8px;border-radius:50%;margin-top:7px}
.rec-text{font-size:.84rem;color:var(--text-secondary);line-height:1.7}
.rec-text strong{color:var(--text-primary);font-weight:500}

footer{padding:24px 0;border-top:1px solid var(--border);text-align:center;font-size:.75rem;color:var(--text-muted)}

@keyframes fadeUp{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
.animate-in{animation:fadeUp .45s ease both}
.d1{animation-delay:.05s}.d2{animation-delay:.1s}.d3{animation-delay:.15s}.d4{animation-delay:.2s}.d5{animation-delay:.25s}.d6{animation-delay:.3s}
</style>
</head>
<body>
<div class="wrapper">
  <header class="animate-in">
    <div class="header-inner">
      <div>
        <div class="brand">
          <div class="brand-icon">SC</div>
          <div>
            <h1>Supply Chain Audit Report</h1>
            <div class="header-sub">Dependency Risk Analysis</div>
          </div>
        </div>
      </div>
      <div class="header-meta" id="headerMeta"></div>
    </div>
  </header>

  <section class="section animate-in d1">
    <div class="section-title">Executive Summary</div>
    <div id="riskGauge" class="risk-gauge"></div>
    <div id="kpiRow" class="kpi-row"></div>
  </section>

  <section class="section animate-in d2">
    <div class="section-title">Vulnerability Breakdown</div>
    <div class="chart-row">
      <div class="chart-card"><h3>Severity Distribution</h3><div id="sevBars" class="severity-bars"></div></div>
      <div class="chart-card"><h3>Composition Overview</h3><div id="donutChart" class="donut-wrap"></div></div>
    </div>
  </section>

  <section class="section animate-in d3">
    <div class="section-title">Dependency Tree</div>
    <div class="tree-container"><h3>Package Dependency Graph</h3><div id="dep-tree"></div></div>
  </section>

  <section class="section animate-in d4">
    <div class="section-title">Package Inventory</div>
    <div class="table-wrap">
      <div class="table-toolbar">
        <input type="text" id="tableSearch" placeholder="Filter packages...">
        <button class="filter-btn active" data-filter="all">All</button>
        <button class="filter-btn" data-filter="vulnerable">Vulnerable</button>
        <button class="filter-btn" data-filter="outdated">Outdated</button>
        <button class="filter-btn" data-filter="critical">Critical</button>
        <button class="filter-btn" data-filter="high">High</button>
      </div>
      <div style="overflow-x:auto"><table><thead id="tableHead"></thead><tbody id="tableBody"></tbody></table></div>
    </div>
  </section>

  <section class="section animate-in d5" id="vulnDetailSection">
    <div class="section-title">Vulnerability Details</div>
    <div id="vulnCards" class="vuln-detail-cards"></div>
  </section>

  <section class="section animate-in d6">
    <div class="section-title">Recommendations</div>
    <div id="recBox" class="recommendations"></div>
  </section>

  <footer>Supply Chain Dependency Auditor &mdash; Generated <span id="footerTime"></span></footer>
</div>

<script>
const DATA = {"target_path": "C:\\Users\\Casho\\Downloads\\supply-chain-auditor\\supply-chain-auditor\\vulnerable-node-test", "ecosystems": ["npm"], "total_dependencies": 48, "direct_dependencies": 2, "transitive_dependencies": 46, "total_vulnerabilities": 38, "critical_count": 1, "high_count": 19, "medium_count": 12, "low_count": 4, "outdated_count": 40, "overall_risk_score": 8.6, "overall_risk_level": "critical", "scan_duration": 36.54, "audits": [{"package": {"name": "express", "version": "4.16.0", "ecosystem": "npm", "is_direct": true, "latest_version": "5.2.1", "license": "MIT", "description": "Fast, unopinionated, minimalist web framework", "is_outdated": true, "depth": 0, "children": [{"name": "qs", "version": "6.5.1", "ecosystem": "npm", "is_direct": false, "latest_version": "6.15.0", "license": "BSD-3-Clause", "description": "A querystring parser that supports nesting and arrays, with a depth limit", "is_outdated": true, "depth": 1, "children": []}, {"name": "depd", "version": "1.1.1", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.0", "license": "MIT", "description": "Deprecate all the things", "is_outdated": true, "depth": 1, "children": []}, {"name": "etag", "version": "1.8.1", "ecosystem": "npm", "is_direct": false, "latest_version": "1.8.1", "license": "MIT", "description": "Create simple HTTP ETags", "is_outdated": false, "depth": 1, "children": []}, {"name": "send", "version": "0.16.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.2.1", "license": "MIT", "description": "Better streaming static file server with Range and conditional-GET support", "is_outdated": true, "depth": 1, "children": [{"name": "ms", "version": "2.0.0", "ecosystem": "npm", "is_direct": false, "latest_version": "2.1.3", "license": "MIT", "description": "Tiny milisecond conversion utility", "is_outdated": true, "depth": 2, "children": []}, {"name": "mime", "version": "1.4.1", "ecosystem": "npm", "is_direct": false, "latest_version": "4.1.0", "license": "MIT", "description": "A comprehensive library for mime-type mapping", "is_outdated": true, "depth": 2, "children": []}, {"name": "debug", "version": "2.6.9", "ecosystem": "npm", "is_direct": false, "latest_version": "4.4.3", "license": "MIT", "description": "small debugging utility", "is_outdated": true, "depth": 2, "children": []}, {"name": "fresh", "version": "0.5.2", "ecosystem": "npm", "is_direct": false, "latest_version": "0.5.2", "license": "MIT", "description": "HTTP response freshness testing", "is_outdated": false, "depth": 2, "children": []}, {"name": "destroy", "version": "1.0.4", "ecosystem": "npm", "is_direct": false, "latest_version": "1.2.0", "license": "MIT", "description": "destroy a stream if possible", "is_outdated": true, "depth": 2, "children": []}, {"name": "statuses", "version": "1.3.1", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.2", "license": "MIT", "description": "HTTP status utility", "is_outdated": true, "depth": 2, "children": []}, {"name": "encodeurl", "version": "1.0.1", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.0", "license": "MIT", "description": "Encode a URL to a percent-encoded form, excluding already-encoded sequences", "is_outdated": true, "depth": 2, "children": []}, {"name": "escape-html", "version": "1.0.3", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.3", "license": "MIT", "description": "Escape string for use in HTML", "is_outdated": false, "depth": 2, "children": []}, {"name": "http-errors", "version": "1.6.2", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.1", "license": "MIT", "description": "Create HTTP error objects", "is_outdated": true, "depth": 2, "children": [{"name": "inherits", "version": "2.0.3", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.4", "license": "ISC", "description": "Browser-friendly inheritance fully compatible with standard node.js inherits()", "is_outdated": true, "depth": 3, "children": []}, {"name": "setprototypeof", "version": "1.0.3", "ecosystem": "npm", "is_direct": false, "latest_version": "1.2.0", "license": "ISC", "description": "A small polyfill for Object.setprototypeof", "is_outdated": true, "depth": 3, "children": []}]}, {"name": "on-finished", "version": "2.3.0", "ecosystem": "npm", "is_direct": false, "latest_version": "2.4.1", "license": "MIT", "description": "Execute a callback when a request closes, finishes, or errors", "is_outdated": true, "depth": 2, "children": [{"name": "ee-first", "version": "1.1.1", "ecosystem": "npm", "is_direct": false, "latest_version": "1.1.1", "license": "MIT", "description": "return the first event in a set of ee/event pairs", "is_outdated": false, "depth": 3, "children": []}]}, {"name": "range-parser", "version": "1.2.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.2.1", "license": "MIT", "description": "Range header field string parser", "is_outdated": true, "depth": 2, "children": []}]}, {"name": "vary", "version": "1.1.2", "ecosystem": "npm", "is_direct": false, "latest_version": "1.1.2", "license": "MIT", "description": "Manipulate the HTTP Vary header", "is_outdated": false, "depth": 1, "children": []}, {"name": "cookie", "version": "0.3.1", "ecosystem": "npm", "is_direct": false, "latest_version": "1.1.1", "license": "MIT", "description": "HTTP server cookie parsing and serialization", "is_outdated": true, "depth": 1, "children": []}, {"name": "accepts", "version": "1.3.4", "ecosystem": "npm", "is_direct": false, "latest_version": "1.3.8", "license": "MIT", "description": "Higher-level content negotiation", "is_outdated": true, "depth": 1, "children": [{"name": "mime-types", "version": "2.1.16", "ecosystem": "npm", "is_direct": false, "latest_version": "3.0.2", "license": "MIT", "description": "The ultimate javascript content-type utility.", "is_outdated": true, "depth": 2, "children": [{"name": "mime-db", "version": "1.29.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.54.0", "license": "MIT", "description": "Media Type Database", "is_outdated": true, "depth": 3, "children": []}]}, {"name": "negotiator", "version": "0.6.1", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.0", "license": "MIT", "description": "HTTP content negotiation", "is_outdated": true, "depth": 2, "children": []}]}, {"name": "methods", "version": "1.1.2", "ecosystem": "npm", "is_direct": false, "latest_version": "1.1.2", "license": "MIT", "description": "HTTP methods that node supports", "is_outdated": false, "depth": 1, "children": []}, {"name": "type-is", "version": "1.6.15", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.1", "license": "MIT", "description": "Infer the content-type of a request.", "is_outdated": true, "depth": 1, "children": [{"name": "media-typer", "version": "0.3.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.1.0", "license": "MIT", "description": "Simple RFC 6838 media type parser and formatter", "is_outdated": true, "depth": 2, "children": []}]}, {"name": "parseurl", "version": "1.3.2", "ecosystem": "npm", "is_direct": false, "latest_version": "1.3.3", "license": "MIT", "description": "parse a url with memoization", "is_outdated": true, "depth": 1, "children": []}, {"name": "proxy-addr", "version": "2.0.2", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.7", "license": "MIT", "description": "Determine address of proxied request", "is_outdated": true, "depth": 1, "children": [{"name": "forwarded", "version": "0.1.2", "ecosystem": "npm", "is_direct": false, "latest_version": "0.2.0", "license": "MIT", "description": "Parse HTTP X-Forwarded-For header", "is_outdated": true, "depth": 2, "children": []}, {"name": "ipaddr.js", "version": "1.5.2", "ecosystem": "npm", "is_direct": false, "latest_version": "2.3.0", "license": "MIT", "description": "A library for manipulating IPv4 and IPv6 addresses in JavaScript.", "is_outdated": true, "depth": 2, "children": []}]}, {"name": "body-parser", "version": "1.18.2", "ecosystem": "npm", "is_direct": false, "latest_version": "2.2.2", "license": "MIT", "description": "Node.js body parsing middleware", "is_outdated": true, "depth": 1, "children": [{"name": "bytes", "version": "3.0.0", "ecosystem": "npm", "is_direct": false, "latest_version": "3.1.2", "license": "MIT", "description": "Utility to parse a string bytes to bytes and vice-versa", "is_outdated": true, "depth": 2, "children": []}, {"name": "raw-body", "version": "2.3.2", "ecosystem": "npm", "is_direct": false, "latest_version": "3.0.2", "license": "MIT", "description": "Get and validate the raw body of a readable stream.", "is_outdated": true, "depth": 2, "children": [{"name": "unpipe", "version": "1.0.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.0", "license": "MIT", "description": "Unpipe a stream from all destinations", "is_outdated": false, "depth": 3, "children": []}, {"name": "iconv-lite", "version": "0.4.19", "ecosystem": "npm", "is_direct": false, "latest_version": "0.7.2", "license": "MIT", "description": "Convert character encodings in pure javascript.", "is_outdated": true, "depth": 3, "children": []}]}, {"name": "content-type", "version": "1.0.4", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.5", "license": "MIT", "description": "Create and parse HTTP Content-Type header", "is_outdated": true, "depth": 2, "children": []}]}, {"name": "safe-buffer", "version": "5.1.1", "ecosystem": "npm", "is_direct": false, "latest_version": "5.2.1", "license": "MIT", "description": "Safer Node.js Buffer API", "is_outdated": true, "depth": 1, "children": []}, {"name": "utils-merge", "version": "1.0.1", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.1", "license": "MIT", "description": "merge() utility function", "is_outdated": false, "depth": 1, "children": []}, {"name": "finalhandler", "version": "1.1.0", "ecosystem": "npm", "is_direct": false, "latest_version": "2.1.1", "license": "MIT", "description": "Node.js final http responder", "is_outdated": true, "depth": 1, "children": []}, {"name": "serve-static", "version": "1.13.0", "ecosystem": "npm", "is_direct": false, "latest_version": "2.2.1", "license": "MIT", "description": "Serve static files", "is_outdated": true, "depth": 1, "children": []}, {"name": "array-flatten", "version": "1.1.1", "ecosystem": "npm", "is_direct": false, "latest_version": "3.0.0", "license": "MIT", "description": "Flatten an array of nested arrays into a single flat array", "is_outdated": true, "depth": 1, "children": []}, {"name": "path-to-regexp", "version": "0.1.7", "ecosystem": "npm", "is_direct": false, "latest_version": "8.3.0", "license": "MIT", "description": "Express style path to RegExp utility", "is_outdated": true, "depth": 1, "children": []}, {"name": "cookie-signature", "version": "1.0.6", "ecosystem": "npm", "is_direct": false, "latest_version": "1.2.2", "license": "MIT", "description": "Sign and unsign cookies", "is_outdated": true, "depth": 1, "children": []}, {"name": "merge-descriptors", "version": "1.0.1", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.0", "license": "MIT", "description": "Merge objects using descriptors", "is_outdated": true, "depth": 1, "children": []}, {"name": "content-disposition", "version": "0.5.2", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.1", "license": "MIT", "description": "Create and parse Content-Disposition header", "is_outdated": true, "depth": 1, "children": []}]}, "vulnerabilities": [{"id": "CVE-2020-26296", "source": "NVD", "summary": "Vega is a visualization grammar, a declarative format for creating, saving, and sharing interactive visualization designs. Vega in an npm package. In Vega before version 5.17.3 there is an XSS vulnerability in Vega expressions. Through a specially crafted Vega expression, an attacker could execute a", "severity": "high", "cvss_score": 8.7, "affected_versions": "", "fixed_version": null, "references": ["https://github.com/vega/vega/issues/3018", "https://github.com/vega/vega/pull/3019", "https://github.com/vega/vega/releases/tag/v5.17.3", "https://github.com/vega/vega/security/advisories/GHSA-r2qc-w64x-6j54", "https://www.npmjs.com/package/vega"], "published": "2020-12-30", "cwe_ids": ["CWE-79"]}, {"id": "CVE-2016-10703", "source": "NVD", "summary": "A regular expression Denial of Service (DoS) vulnerability in the file lib/ecstatic.js of the ecstatic npm package, before version 2.0.0, allows a remote attacker to overload and crash a server by passing a maliciously crafted string.", "severity": "high", "cvss_score": 7.5, "affected_versions": "", "fixed_version": null, "references": ["https://advisory.checkmarx.net/advisory/CX-2016-4450", "https://github.com/jfhbrook/node-ecstatic/commit/71ce93988ead4b561a8592168c72143907189f01", "https://www.checkmarx.com/advisories/denial-of-service-dos-vulnerability-in-ecstatic-npm-package/", "https://advisory.checkmarx.net/advisory/CX-2016-4450", "https://github.com/jfhbrook/node-ecstatic/commit/71ce93988ead4b561a8592168c72143907189f01"], "published": "2017-12-14", "cwe_ids": ["CWE-20"]}, {"id": "CVE-2018-7560", "source": "NVD", "summary": "index.js in the Anton Myshenin aws-lambda-multipart-parser NPM package before 0.1.2 has a Regular Expression Denial of Service (ReDoS) issue via a crafted multipart/form-data boundary string.", "severity": "high", "cvss_score": 7.5, "affected_versions": "", "fixed_version": null, "references": ["https://github.com/myshenin/aws-lambda-multipart-parser/commit/56ccb03af4dddebc2b2defb348b6558783d5757e", "https://github.com/myshenin/aws-lambda-multipart-parser/commit/56ccb03af4dddebc2b2defb348b6558783d5757e"], "published": "2018-03-04", "cwe_ids": ["CWE-20"]}, {"id": "CVE-2018-11615", "source": "NVD", "summary": "This vulnerability allows remote attackers to deny service on vulnerable installations of npm mosca 2.8.1. Authentication is not required to exploit this vulnerability. The specific flaw exists within the processing of topics. A crafted regular expression can cause the broker to crash. An attacker c", "severity": "high", "cvss_score": 7.5, "affected_versions": "", "fixed_version": null, "references": ["https://zerodayinitiative.com/advisories/ZDI-18-583", "https://zerodayinitiative.com/advisories/ZDI-18-583"], "published": "2018-08-30", "cwe_ids": ["CWE-20", "CWE-185"]}, {"id": "CVE-2020-26289", "source": "NVD", "summary": "date-and-time is an npm package for manipulating date and time. In date-and-time before version 0.14.2, there a regular expression involved in parsing which can be exploited to to cause a denial of service. This is fixed in version 0.14.2.", "severity": "high", "cvss_score": 7.5, "affected_versions": "", "fixed_version": null, "references": ["https://github.com/knowledgecode/date-and-time/commit/9e4b501eacddccc8b1f559fb414f48472ee17c2a", "https://github.com/knowledgecode/date-and-time/security/advisories/GHSA-r92x-f52r-x54g", "https://www.npmjs.com/package/date-and-time", "https://github.com/knowledgecode/date-and-time/commit/9e4b501eacddccc8b1f559fb414f48472ee17c2a", "https://github.com/knowledgecode/date-and-time/security/advisories/GHSA-r92x-f52r-x54g"], "published": "2020-12-28", "cwe_ids": ["CWE-400"]}, {"id": "GHSA-rv95-896h-c2vc", "source": "OSV", "summary": "Express.js Open Redirect in malformed URLs", "severity": "medium", "cvss_score": 6.1, "affected_versions": ">=5.0.0-alpha.1, <5.0.0-beta.3", "fixed_version": "5.0.0-beta.3", "references": ["https://github.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc", "https://nvd.nist.gov/vuln/detail/CVE-2024-29041", "https://github.com/koajs/koa/issues/1800", "https://github.com/expressjs/express/pull/5539", "https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd"], "published": "2024-03-25T19:40:26Z", "cwe_ids": ["CWE-1286", "CWE-601"]}, {"id": "CVE-2020-26256", "source": "NVD", "summary": "Fast-csv is an npm package for parsing and formatting CSVs or any other delimited value file in node. In fast-cvs before version 4.3.6 there is a possible ReDoS vulnerability (Regular Expression Denial of Service) when using ignoreEmpty option when parsing. This has been patched in `v4.3.6` You will", "severity": "medium", "cvss_score": 5.7, "affected_versions": "", "fixed_version": null, "references": ["https://github.com/C2FO/fast-csv/commit/4bbd39f26a8cd7382151ab4f5fb102234b2f829e", "https://github.com/C2FO/fast-csv/issues/540", "https://github.com/C2FO/fast-csv/security/advisories/GHSA-8cv5-p934-3hwp", "https://lgtm.com/query/8609731774537641779/", "https://www.npmjs.com/package/%40fast-csv/parse"], "published": "2020-12-08", "cwe_ids": ["CWE-400", "CWE-400"]}, {"id": "CVE-2021-21252", "source": "NVD", "summary": "The jQuery Validation Plugin provides drop-in validation for your existing forms. It is published as an npm package \"jquery-validation\". jquery-validation before version 1.19.3 contains one or more regular expressions that are vulnerable to ReDoS (Regular Expression Denial of Service). This is fixed", "severity": "medium", "cvss_score": 5.3, "affected_versions": "", "fixed_version": null, "references": ["https://github.com/jquery-validation/jquery-validation/commit/5d8f29eef363d043a8fec4eb86d42cadb5fa5f7d", "https://github.com/jquery-validation/jquery-validation/pull/2371", "https://github.com/jquery-validation/jquery-validation/security/advisories/GHSA-jxwx-85vp-gvwm", "https://lists.debian.org/debian-lts-announce/2023/08/msg00040.html", "https://security.netapp.com/advisory/ntap-20210219-0005/"], "published": "2021-01-13", "cwe_ids": ["CWE-400", "CWE-400"]}, {"id": "CVE-2021-21317", "source": "NVD", "summary": "uap-core in an open-source npm package which contains the core of BrowserScope's original user agent string parser. In uap-core before version 0.11.0, some regexes are vulnerable to regular expression denial of service (REDoS) due to overlapping capture groups. This allows remote attackers to overlo", "severity": "medium", "cvss_score": 5.3, "affected_versions": "", "fixed_version": null, "references": ["https://github.com/ua-parser/uap-core/commit/dc9925d458214cfe87b93e35346980612f6ae96c", "https://github.com/ua-parser/uap-core/security/advisories/GHSA-p4pj-mg4r-x6v4", "https://www.npmjs.com/package/uap-core", "https://github.com/ua-parser/uap-core/commit/dc9925d458214cfe87b93e35346980612f6ae96c", "https://github.com/ua-parser/uap-core/security/advisories/GHSA-p4pj-mg4r-x6v4"], "published": "2021-02-16", "cwe_ids": ["CWE-400", "CWE-1333"]}, {"id": "GHSA-qw6h-vgh9-j6wx", "source": "OSV", "summary": "express vulnerable to XSS via response.redirect()", "severity": "medium", "cvss_score": 5.0, "affected_versions": ">=5.0.0-alpha.1, <5.0.0", "fixed_version": "5.0.0", "references": ["https://github.com/expressjs/express/security/advisories/GHSA-qw6h-vgh9-j6wx", "https://nvd.nist.gov/vuln/detail/CVE-2024-43796", "https://github.com/expressjs/express/commit/54271f69b511fea198471e6ff3400ab805d6b553", "https://github.com/expressjs/express"], "published": "2024-09-10T19:41:04Z", "cwe_ids": ["CWE-79"]}, {"id": "CVE-2019-16769", "source": "NVD", "summary": "The serialize-javascript npm package before version 2.1.1 is vulnerable to Cross-site Scripting (XSS). It does not properly mitigate against unsafe characters in serialized regular expressions. This vulnerability is not affected on Node.js environment since Node.js's implementation of RegExp.prototy", "severity": "medium", "cvss_score": 4.2, "affected_versions": "", "fixed_version": null, "references": ["https://github.com/yahoo/serialize-javascript/security/advisories/GHSA-h9rv-jmmf-4pgx", "https://github.com/yahoo/serialize-javascript/security/advisories/GHSA-h9rv-jmmf-4pgx"], "published": "2019-12-05", "cwe_ids": ["CWE-79", "CWE-79"]}, {"id": "CVE-2019-16772", "source": "NVD", "summary": "The serialize-to-js NPM package before version 3.0.1 is vulnerable to Cross-site Scripting (XSS). It does not properly mitigate against unsafe characters in serialized regular expressions. This vulnerability is not affected on Node.js environment since Node.js's implementation of RegExp.prototype.to", "severity": "low", "cvss_score": 3.1, "affected_versions": "", "fixed_version": null, "references": ["https://github.com/commenthol/serialize-to-js/commit/181d7d583ae5293cd47cc99b14ad13352875f3e3", "https://github.com/commenthol/serialize-to-js/security/advisories/GHSA-3fjq-93xj-3f3f", "https://github.com/commenthol/serialize-to-js/commit/181d7d583ae5293cd47cc99b14ad13352875f3e3", "https://github.com/commenthol/serialize-to-js/security/advisories/GHSA-3fjq-93xj-3f3f"], "published": "2019-12-07", "cwe_ids": ["CWE-79", "CWE-79"]}], "risk_score": 10.0, "risk_level": "critical"}, {"package": {"name": "send", "version": "0.16.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.2.1", "license": "MIT", "description": "Better streaming static file server with Range and conditional-GET support", "is_outdated": true, "depth": 1, "children": [{"name": "ms", "version": "2.0.0", "ecosystem": "npm", "is_direct": false, "latest_version": "2.1.3", "license": "MIT", "description": "Tiny milisecond conversion utility", "is_outdated": true, "depth": 2, "children": []}, {"name": "mime", "version": "1.4.1", "ecosystem": "npm", "is_direct": false, "latest_version": "4.1.0", "license": "MIT", "description": "A comprehensive library for mime-type mapping", "is_outdated": true, "depth": 2, "children": []}, {"name": "debug", "version": "2.6.9", "ecosystem": "npm", "is_direct": false, "latest_version": "4.4.3", "license": "MIT", "description": "small debugging utility", "is_outdated": true, "depth": 2, "children": []}, {"name": "fresh", "version": "0.5.2", "ecosystem": "npm", "is_direct": false, "latest_version": "0.5.2", "license": "MIT", "description": "HTTP response freshness testing", "is_outdated": false, "depth": 2, "children": []}, {"name": "destroy", "version": "1.0.4", "ecosystem": "npm", "is_direct": false, "latest_version": "1.2.0", "license": "MIT", "description": "destroy a stream if possible", "is_outdated": true, "depth": 2, "children": []}, {"name": "statuses", "version": "1.3.1", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.2", "license": "MIT", "description": "HTTP status utility", "is_outdated": true, "depth": 2, "children": []}, {"name": "encodeurl", "version": "1.0.1", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.0", "license": "MIT", "description": "Encode a URL to a percent-encoded form, excluding already-encoded sequences", "is_outdated": true, "depth": 2, "children": []}, {"name": "escape-html", "version": "1.0.3", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.3", "license": "MIT", "description": "Escape string for use in HTML", "is_outdated": false, "depth": 2, "children": []}, {"name": "http-errors", "version": "1.6.2", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.1", "license": "MIT", "description": "Create HTTP error objects", "is_outdated": true, "depth": 2, "children": [{"name": "inherits", "version": "2.0.3", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.4", "license": "ISC", "description": "Browser-friendly inheritance fully compatible with standard node.js inherits()", "is_outdated": true, "depth": 3, "children": []}, {"name": "setprototypeof", "version": "1.0.3", "ecosystem": "npm", "is_direct": false, "latest_version": "1.2.0", "license": "ISC", "description": "A small polyfill for Object.setprototypeof", "is_outdated": true, "depth": 3, "children": []}]}, {"name": "on-finished", "version": "2.3.0", "ecosystem": "npm", "is_direct": false, "latest_version": "2.4.1", "license": "MIT", "description": "Execute a callback when a request closes, finishes, or errors", "is_outdated": true, "depth": 2, "children": [{"name": "ee-first", "version": "1.1.1", "ecosystem": "npm", "is_direct": false, "latest_version": "1.1.1", "license": "MIT", "description": "return the first event in a set of ee/event pairs", "is_outdated": false, "depth": 3, "children": []}]}, {"name": "range-parser", "version": "1.2.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.2.1", "license": "MIT", "description": "Range header field string parser", "is_outdated": true, "depth": 2, "children": []}]}, "vulnerabilities": [{"id": "CVE-2023-39655", "source": "NVD", "summary": "A host header injection vulnerability exists in the NPM package @perfood/couch-auth versions <= 0.20.0. By sending a specially crafted host header in the forgot password request, it is possible to send password reset links to users which, once clicked, lead to an attacker-controlled server and thus ", "severity": "critical", "cvss_score": 9.6, "affected_versions": "", "fixed_version": null, "references": ["https://github.com/dub-flow/vulnerability-research/tree/main/CVE-2023-39655", "https://www.npmjs.com/package/%40perfood/couch-auth", "https://github.com/dub-flow/vulnerability-research/tree/main/CVE-2023-39655", "https://www.npmjs.com/package/%40perfood/couch-auth"], "published": "2024-01-03", "cwe_ids": ["CWE-74", "CWE-74"]}, {"id": "CVE-2024-37150", "source": "NVD", "summary": "An issue in `.npmrc` support in Deno 1.44.0 was discovered where Deno would send `.npmrc` credentials for the scope to the tarball URL when the registry provided URLs for a tarball on a different domain. All users relying on .npmrc are potentially affected by this vulnerability if their private regi", "severity": "high", "cvss_score": 7.6, "affected_versions": "", "fixed_version": null, "references": ["https://github.com/denoland/deno/commit/566adb7c0a0c0845e90a6e867a2c0ef5d2ada575", "https://github.com/denoland/deno/security/advisories/GHSA-rfc6-h225-3vxv", "https://github.com/npm/cli/wiki/%22No-auth-for-URI,-but-auth-present-for-scoped-registry%22", "https://github.com/denoland/deno/commit/566adb7c0a0c0845e90a6e867a2c0ef5d2ada575", "https://github.com/denoland/deno/security/advisories/GHSA-rfc6-h225-3vxv"], "published": "2024-06-06", "cwe_ids": ["CWE-200", "CWE-706"]}, {"id": "CVE-2021-29486", "source": "NVD", "summary": "cumulative-distribution-function is an open source npm library used which calculates statistical cumulative distribution function from data array of x values. In versions prior to 2.0.0 apps using this library on improper data may crash or go into an infinite-loop. In the case of a nodejs server-app", "severity": "high", "cvss_score": 7.5, "affected_versions": "", "fixed_version": null, "references": ["https://github.com/DrPaulBrewer/cumulative-distribution-function/issues/7", "https://github.com/DrPaulBrewer/cumulative-distribution-function/pull/8", "https://github.com/DrPaulBrewer/cumulative-distribution-function/security/advisories/GHSA-58qp-5328-v7mh", "https://www.npmjs.com/package/cumulative-distribution-function", "https://github.com/DrPaulBrewer/cumulative-distribution-function/issues/7"], "published": "2021-04-30", "cwe_ids": ["CWE-20", "CWE-835", "CWE-20"]}, {"id": "CVE-2024-4068", "source": "NVD", "summary": "The NPM package `braces`, versions prior to 3.0.3, fails to limit the number of characters it can handle, which could lead to Memory Exhaustion. In `lib/parse.js,` if a malicious user sends \"imbalanced braces\" as input, the parsing will enter a loop, which will cause the program to start allocating ", "severity": "high", "cvss_score": 7.5, "affected_versions": "", "fixed_version": null, "references": ["https://devhub.checkmarx.com/cve-details/CVE-2024-4068/", "https://github.com/micromatch/braces/commit/415d660c3002d1ab7e63dbf490c9851da80596ff", "https://github.com/micromatch/braces/issues/35", "https://github.com/micromatch/braces/pull/37", "https://github.com/micromatch/braces/pull/40"], "published": "2024-05-14", "cwe_ids": ["CWE-1050", "CWE-400"]}, {"id": "CVE-2024-57177", "source": "NVD", "summary": "A host header injection vulnerability exists in the NPM package of perfood/couch-auth <= 0.21.2. By sending a specially crafted host header in the email change confirmation request, it is possible to trigger a SSTI which can be leveraged to run limited commands or leak server-side information", "severity": "high", "cvss_score": 7.3, "affected_versions": "", "fixed_version": null, "references": ["https://github.com/perfood/couch-auth", "https://github.com/waristea/cve-research/tree/main/CVE-2024-57177"], "published": "2025-02-10", "cwe_ids": ["CWE-1336"]}, {"id": "CVE-2023-41896", "source": "NVD", "summary": "Home assistant is an open source home automation. Whilst auditing the frontend code to identify hidden parameters, Cure53 detected `auth_callback=1`, which is leveraged by the WebSocket authentication logic in tandem with the `state` parameter. The state parameter contains the `hassUrl`, which is su", "severity": "high", "cvss_score": 7.1, "affected_versions": "", "fixed_version": null, "references": ["https://github.com/home-assistant/core/security/advisories/GHSA-935v-rmg9-44mw", "https://github.com/home-assistant/core/security/advisories/GHSA-cr83-q7r2-7f5q", "https://github.com/home-assistant/core/security/advisories/GHSA-935v-rmg9-44mw", "https://github.com/home-assistant/core/security/advisories/GHSA-cr83-q7r2-7f5q"], "published": "2023-10-19", "cwe_ids": ["CWE-345", "CWE-345"]}, {"id": "CVE-2025-56648", "source": "NVD", "summary": "npm parcel 2.0.0-alpha and before has an Origin Validation Error vulnerability. Malicious websites can send XMLHTTPRequests to the application's development server and read the response to steal source code when developers visit them.", "severity": "medium", "cvss_score": 6.5, "affected_versions": "", "fixed_version": null, "references": ["https://gist.github.com/R4356th/41f468def606b2406e36f7193f5322b8", "https://github.com/parcel-bundler/parcel/commit/4bc56e3242a85491c7edf589966e9b44c6330c49", "https://github.com/parcel-bundler/parcel/discussions/10089", "https://github.com/parcel-bundler/parcel/issues/10216"], "published": "2025-09-17", "cwe_ids": ["CWE-346"]}, {"id": "CVE-2023-30543", "source": "NVD", "summary": "@web3-react is a framework for building Ethereum Apps . In affected versions the `chainId` may be outdated if the user changes chains as part of the connection flow. This means that the value of `chainId` returned by `useWeb3React()` may be incorrect. In an application, this means that any data deri", "severity": "medium", "cvss_score": 5.2, "affected_versions": "", "fixed_version": null, "references": ["https://github.com/Uniswap/web3-react/pull/749", "https://github.com/Uniswap/web3-react/security/advisories/GHSA-8pf3-6fgr-3g3g", "https://github.com/Uniswap/web3-react/pull/749", "https://github.com/Uniswap/web3-react/security/advisories/GHSA-8pf3-6fgr-3g3g"], "published": "2023-04-17", "cwe_ids": ["CWE-362"]}, {"id": "GHSA-m6fv-jmcg-4jfg", "source": "OSV", "summary": "send vulnerable to template injection that can lead to XSS", "severity": "medium", "cvss_score": 5.0, "affected_versions": ">=0, <0.19.0", "fixed_version": "0.19.0", "references": ["https://github.com/pillarjs/send/security/advisories/GHSA-m6fv-jmcg-4jfg", "https://nvd.nist.gov/vuln/detail/CVE-2024-43799", "https://github.com/pillarjs/send/commit/ae4f2989491b392ae2ef3b0015a019770ae65d35", "https://github.com/pillarjs/send", "https://lists.debian.org/debian-lts-announce/2025/06/msg00022.html"], "published": "2024-09-10T19:42:41Z", "cwe_ids": ["CWE-79"]}, {"id": "CVE-2023-48711", "source": "NVD", "summary": "google-translate-api-browser is an npm package which interfaces with the google translate web api. A Server-Side Request Forgery (SSRF) Vulnerability is present in applications utilizing the `google-translate-api-browser` package and exposing the `translateOptions` to the end user. An attacker can s", "severity": "low", "cvss_score": 3.7, "affected_versions": "", "fixed_version": null, "references": ["https://github.com/cjvnjde/google-translate-api-browser/commit/33c2eac4a21c6504409e7b06dd16e6346f93d34b", "https://github.com/cjvnjde/google-translate-api-browser/security/advisories/GHSA-4233-7q5q-m7p6", "https://github.com/cjvnjde/google-translate-api-browser/commit/33c2eac4a21c6504409e7b06dd16e6346f93d34b", "https://github.com/cjvnjde/google-translate-api-browser/security/advisories/GHSA-4233-7q5q-m7p6"], "published": "2023-11-24", "cwe_ids": ["CWE-918"]}, {"id": "CVE-2026-2391", "source": "NVD", "summary": "### Summary\nThe `arrayLimit` option in qs does not enforce limits for comma-separated values when `comma: true` is enabled, allowing attackers to cause denial-of-service via memory exhaustion. This is a bypass of the array limit enforcement, similar to the bracket notation bypass addressed in GHSA-6", "severity": "low", "cvss_score": 3.7, "affected_versions": "", "fixed_version": null, "references": ["https://github.com/ljharb/qs/commit/f6a7abff1f13d644db9b05fe4f2c98ada6bf8482", "https://github.com/ljharb/qs/security/advisories/GHSA-w7fw-mjwx-w883", "https://github.com/ljharb/qs/security/advisories/GHSA-w7fw-mjwx-w883"], "published": "2026-02-12", "cwe_ids": ["CWE-20"]}], "risk_score": 10.0, "risk_level": "critical"}, {"package": {"name": "lodash", "version": "4.17.15", "ecosystem": "npm", "is_direct": true, "latest_version": "4.17.23", "license": "MIT", "description": "Lodash modular utilities.", "is_outdated": true, "depth": 0, "children": []}, "vulnerabilities": [{"id": "GHSA-p6mc-m468-83gw", "source": "OSV", "summary": "Prototype Pollution in lodash", "severity": "high", "cvss_score": 7.4, "affected_versions": ">=3.7.0, <4.17.19", "fixed_version": "4.17.19", "references": ["https://nvd.nist.gov/vuln/detail/CVE-2020-8203", "https://github.com/lodash/lodash/issues/4744", "https://github.com/lodash/lodash/issues/4874", "https://github.com/github/advisory-database/pull/2884", "https://github.com/lodash/lodash/commit/c84fe82760fb2d3e03a63379b297a1cc1a2fce12"], "published": "2020-07-15T19:15:48Z", "cwe_ids": ["CWE-1321", "CWE-770"]}, {"id": "GHSA-35jh-r3h4-6jhm", "source": "OSV", "summary": "Command Injection in lodash", "severity": "high", "cvss_score": 7.2, "affected_versions": ">=0, <4.17.21", "fixed_version": "4.17.21", "references": ["https://nvd.nist.gov/vuln/detail/CVE-2021-23337", "https://github.com/lodash/lodash/commit/3469357cff396a26c363f8c1b5a91dde28ba4b1c", "https://www.oracle.com/security-alerts/cpuoct2021.html", "https://www.oracle.com/security-alerts/cpujul2022.html", "https://www.oracle.com/security-alerts/cpujan2022.html"], "published": "2021-05-06T16:05:51Z", "cwe_ids": ["CWE-77", "CWE-94"]}, {"id": "GHSA-xxjr-mmjv-4gpg", "source": "OSV", "summary": "Lodash has Prototype Pollution Vulnerability in `_.unset` and `_.omit` functions", "severity": "medium", "cvss_score": 6.5, "affected_versions": ">=4.0.0, <4.17.23", "fixed_version": "4.17.23", "references": ["https://github.com/lodash/lodash/security/advisories/GHSA-xxjr-mmjv-4gpg", "https://nvd.nist.gov/vuln/detail/CVE-2025-13465", "https://github.com/lodash/lodash/commit/edadd452146f7e4bad4ea684e955708931d84d81", "https://github.com/lodash/lodash"], "published": "2026-01-21T23:01:22Z", "cwe_ids": ["CWE-1321"]}, {"id": "GHSA-29mw-wpgm-hmr9", "source": "OSV", "summary": "Regular Expression Denial of Service (ReDoS) in lodash", "severity": "medium", "cvss_score": 5.3, "affected_versions": ">=4.0.0, <4.17.21", "fixed_version": "4.17.21", "references": ["https://nvd.nist.gov/vuln/detail/CVE-2020-28500", "https://github.com/github/advisory-database/pull/6139", "https://github.com/lodash/lodash/pull/5065", "https://github.com/lodash/lodash/pull/5065/commits/02906b8191d3c100c193fe6f7b27d1c40f200bb7", "https://github.com/lodash/lodash/commit/c4847ebe7d14540bb28a8b932a9ce1b9ecbfee1a"], "published": "2022-01-06T20:30:46Z", "cwe_ids": ["CWE-1333", "CWE-400"]}], "risk_score": 7.9, "risk_level": "high"}, {"package": {"name": "qs", "version": "6.5.1", "ecosystem": "npm", "is_direct": false, "latest_version": "6.15.0", "license": "BSD-3-Clause", "description": "A querystring parser that supports nesting and arrays, with a depth limit", "is_outdated": true, "depth": 1, "children": []}, "vulnerabilities": [{"id": "GHSA-6rw7-vpxm-498p", "source": "OSV", "summary": "qs's arrayLimit bypass in its bracket notation allows DoS via memory exhaustion", "severity": "high", "cvss_score": 7.5, "affected_versions": ">=0, <6.14.1", "fixed_version": "6.14.1", "references": ["https://github.com/ljharb/qs/security/advisories/GHSA-6rw7-vpxm-498p", "https://nvd.nist.gov/vuln/detail/CVE-2025-15284", "https://github.com/ljharb/qs/commit/3086902ecf7f088d0d1803887643ac6c03d415b9", "https://github.com/ljharb/qs"], "published": "2025-12-30T21:02:54Z", "cwe_ids": ["CWE-20"]}, {"id": "GHSA-hrpp-h998-j3pp", "source": "OSV", "summary": "qs vulnerable to Prototype Pollution", "severity": "high", "cvss_score": 7.5, "affected_versions": ">=0, <6.2.4", "fixed_version": "6.2.4", "references": ["https://nvd.nist.gov/vuln/detail/CVE-2022-24999", "https://github.com/ljharb/qs/pull/428", "https://github.com/ljharb/qs/commit/4310742efbd8c03f6495f07906b45213da0a32ec", "https://github.com/ljharb/qs/commit/727ef5d34605108acb3513f72d5435972ed15b68", "https://github.com/ljharb/qs/commit/73205259936317b40f447c5cdb71c5b341848e1b"], "published": "2022-11-27T00:30:50Z", "cwe_ids": ["CWE-1321"]}, {"id": "CVE-2026-2391", "source": "NVD", "summary": "### Summary\nThe `arrayLimit` option in qs does not enforce limits for comma-separated values when `comma: true` is enabled, allowing attackers to cause denial-of-service via memory exhaustion. This is a bypass of the array limit enforcement, similar to the bracket notation bypass addressed in GHSA-6", "severity": "low", "cvss_score": 3.7, "affected_versions": "", "fixed_version": null, "references": ["https://github.com/ljharb/qs/commit/f6a7abff1f13d644db9b05fe4f2c98ada6bf8482", "https://github.com/ljharb/qs/security/advisories/GHSA-w7fw-mjwx-w883", "https://github.com/ljharb/qs/security/advisories/GHSA-w7fw-mjwx-w883"], "published": "2026-02-12", "cwe_ids": ["CWE-20"]}], "risk_score": 6.3, "risk_level": "high"}, {"package": {"name": "ms", "version": "2.0.0", "ecosystem": "npm", "is_direct": false, "latest_version": "2.1.3", "license": "MIT", "description": "Tiny milisecond conversion utility", "is_outdated": true, "depth": 2, "children": []}, "vulnerabilities": [{"id": "CVE-2017-16056", "source": "NVD", "summary": "mssql.js was a malicious module published with the intent to hijack environment variables. It has been unpublished by npm.", "severity": "high", "cvss_score": 7.5, "affected_versions": "", "fixed_version": null, "references": ["https://nodesecurity.io/advisories/485", "https://nodesecurity.io/advisories/485"], "published": "2018-06-07", "cwe_ids": ["CWE-506", "CWE-200"]}, {"id": "CVE-2017-16059", "source": "NVD", "summary": "mssql-node was a malicious module published with the intent to hijack environment variables. It has been unpublished by npm.", "severity": "high", "cvss_score": 7.5, "affected_versions": "", "fixed_version": null, "references": ["https://nodesecurity.io/advisories/480", "https://nodesecurity.io/advisories/480"], "published": "2018-06-07", "cwe_ids": ["CWE-506", "CWE-200"]}], "risk_score": 6.1, "risk_level": "high"}, {"package": {"name": "path-to-regexp", "version": "0.1.7", "ecosystem": "npm", "is_direct": false, "latest_version": "8.3.0", "license": "MIT", "description": "Express style path to RegExp utility", "is_outdated": true, "depth": 1, "children": []}, "vulnerabilities": [{"id": "GHSA-9wv6-86v2-598j", "source": "OSV", "summary": "path-to-regexp outputs backtracking regular expressions", "severity": "high", "cvss_score": 7.5, "affected_versions": ">=4.0.0, <6.3.0", "fixed_version": "6.3.0", "references": ["https://github.com/pillarjs/path-to-regexp/security/advisories/GHSA-9wv6-86v2-598j", "https://nvd.nist.gov/vuln/detail/CVE-2024-45296", "https://github.com/pillarjs/path-to-regexp/commit/29b96b4a1de52824e1ca0f49a701183cc4ed476f", "https://github.com/pillarjs/path-to-regexp/commit/60f2121e9b66b7b622cc01080df0aabda9eedee6", "https://github.com/pillarjs/path-to-regexp/commit/925ac8e3c5780b02f58cbd4e52f95da8ad2ac485"], "published": "2024-09-09T20:19:15Z", "cwe_ids": ["CWE-1333"]}, {"id": "GHSA-rhx6-c78j-4q9w", "source": "OSV", "summary": "path-to-regexp contains a ReDoS", "severity": "high", "cvss_score": 7.5, "affected_versions": ">=0, <0.1.12", "fixed_version": "0.1.12", "references": ["https://github.com/pillarjs/path-to-regexp/security/advisories/GHSA-rhx6-c78j-4q9w", "https://nvd.nist.gov/vuln/detail/CVE-2024-52798", "https://github.com/pillarjs/path-to-regexp/commit/f01c26a013b1889f0c217c643964513acf17f6a4", "https://blakeembrey.com/posts/2024-09-web-redos", "https://github.com/pillarjs/path-to-regexp"], "published": "2024-12-05T22:40:47Z", "cwe_ids": ["CWE-1333"]}], "risk_score": 6.0, "risk_level": "high"}, {"package": {"name": "body-parser", "version": "1.18.2", "ecosystem": "npm", "is_direct": false, "latest_version": "2.2.2", "license": "MIT", "description": "Node.js body parsing middleware", "is_outdated": true, "depth": 1, "children": [{"name": "bytes", "version": "3.0.0", "ecosystem": "npm", "is_direct": false, "latest_version": "3.1.2", "license": "MIT", "description": "Utility to parse a string bytes to bytes and vice-versa", "is_outdated": true, "depth": 2, "children": []}, {"name": "raw-body", "version": "2.3.2", "ecosystem": "npm", "is_direct": false, "latest_version": "3.0.2", "license": "MIT", "description": "Get and validate the raw body of a readable stream.", "is_outdated": true, "depth": 2, "children": [{"name": "unpipe", "version": "1.0.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.0", "license": "MIT", "description": "Unpipe a stream from all destinations", "is_outdated": false, "depth": 3, "children": []}, {"name": "iconv-lite", "version": "0.4.19", "ecosystem": "npm", "is_direct": false, "latest_version": "0.7.2", "license": "MIT", "description": "Convert character encodings in pure javascript.", "is_outdated": true, "depth": 3, "children": []}]}, {"name": "content-type", "version": "1.0.4", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.5", "license": "MIT", "description": "Create and parse HTTP Content-Type header", "is_outdated": true, "depth": 2, "children": []}]}, "vulnerabilities": [{"id": "GHSA-qwcr-r2fm-qrc7", "source": "OSV", "summary": "body-parser vulnerable to denial of service when url encoding is enabled", "severity": "high", "cvss_score": 7.5, "affected_versions": ">=0, <1.20.3", "fixed_version": "1.20.3", "references": ["https://github.com/expressjs/body-parser/security/advisories/GHSA-qwcr-r2fm-qrc7", "https://nvd.nist.gov/vuln/detail/CVE-2024-45590", "https://github.com/expressjs/body-parser/commit/b2695c4450f06ba3b0ccf48d872a229bb41c9bce", "https://github.com/expressjs/body-parser"], "published": "2024-09-10T15:52:39Z", "cwe_ids": ["CWE-405"]}], "risk_score": 3.4, "risk_level": "medium"}, {"package": {"name": "serve-static", "version": "1.13.0", "ecosystem": "npm", "is_direct": false, "latest_version": "2.2.1", "license": "MIT", "description": "Serve static files", "is_outdated": true, "depth": 1, "children": []}, "vulnerabilities": [{"id": "GHSA-cm22-4g7w-348p", "source": "OSV", "summary": "serve-static vulnerable to template injection that can lead to XSS", "severity": "medium", "cvss_score": 5.0, "affected_versions": ">=2.0.0, <2.1.0", "fixed_version": "2.1.0", "references": ["https://github.com/expressjs/serve-static/security/advisories/GHSA-cm22-4g7w-348p", "https://nvd.nist.gov/vuln/detail/CVE-2024-43800", "https://github.com/expressjs/serve-static/commit/0c11fad159898cdc69fd9ab63269b72468ecaf6b", "https://github.com/expressjs/serve-static/commit/ce730896fddce1588111d9ef6fdf20896de5c6fa", "https://github.com/expressjs/serve-static"], "published": "2024-09-10T19:42:33Z", "cwe_ids": ["CWE-79"]}], "risk_score": 1.9, "risk_level": "low"}, {"package": {"name": "inherits", "version": "2.0.3", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.4", "license": "ISC", "description": "Browser-friendly inheritance fully compatible with standard node.js inherits()", "is_outdated": true, "depth": 3, "children": []}, "vulnerabilities": [], "risk_score": 1.2, "risk_level": "low"}, {"package": {"name": "setprototypeof", "version": "1.0.3", "ecosystem": "npm", "is_direct": false, "latest_version": "1.2.0", "license": "ISC", "description": "A small polyfill for Object.setprototypeof", "is_outdated": true, "depth": 3, "children": []}, "vulnerabilities": [], "risk_score": 1.2, "risk_level": "low"}, {"package": {"name": "mime-db", "version": "1.29.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.54.0", "license": "MIT", "description": "Media Type Database", "is_outdated": true, "depth": 3, "children": []}, "vulnerabilities": [], "risk_score": 1.2, "risk_level": "low"}, {"package": {"name": "iconv-lite", "version": "0.4.19", "ecosystem": "npm", "is_direct": false, "latest_version": "0.7.2", "license": "MIT", "description": "Convert character encodings in pure javascript.", "is_outdated": true, "depth": 3, "children": []}, "vulnerabilities": [], "risk_score": 1.2, "risk_level": "low"}, {"package": {"name": "debug", "version": "2.6.9", "ecosystem": "npm", "is_direct": false, "latest_version": "4.4.3", "license": "MIT", "description": "small debugging utility", "is_outdated": true, "depth": 2, "children": []}, "vulnerabilities": [{"id": "CVE-2025-59144", "source": "NVD", "summary": "debug is a JavaScript debugging utility. On 8 September 2025, the npm publishing account for debug was taken over after a phishing attack. Version 4.4.2 was published, functionally identical to the previous patch version, but with a malware payload added attempting to redirect cryptocurrency transac", "severity": "none", "cvss_score": 0.0, "affected_versions": "", "fixed_version": null, "references": ["https://github.com/debug-js/debug/issues/1005", "https://github.com/debug-js/debug/security/advisories/GHSA-4x49-vf9v-38px", "https://socket.dev/blog/npm-author-qix-compromised-in-major-supply-chain-attack", "https://www.aikido.dev/blog/npm-debug-and-chalk-packages-compromised", "https://www.ox.security/blog/npm-packages-compromised"], "published": "2025-09-15", "cwe_ids": ["CWE-506"]}], "risk_score": 1.2, "risk_level": "low"}, {"package": {"name": "mime", "version": "1.4.1", "ecosystem": "npm", "is_direct": false, "latest_version": "4.1.0", "license": "MIT", "description": "A comprehensive library for mime-type mapping", "is_outdated": true, "depth": 2, "children": []}, "vulnerabilities": [], "risk_score": 1.1, "risk_level": "low"}, {"package": {"name": "destroy", "version": "1.0.4", "ecosystem": "npm", "is_direct": false, "latest_version": "1.2.0", "license": "MIT", "description": "destroy a stream if possible", "is_outdated": true, "depth": 2, "children": []}, "vulnerabilities": [], "risk_score": 1.1, "risk_level": "low"}, {"package": {"name": "statuses", "version": "1.3.1", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.2", "license": "MIT", "description": "HTTP status utility", "is_outdated": true, "depth": 2, "children": []}, "vulnerabilities": [], "risk_score": 1.1, "risk_level": "low"}, {"package": {"name": "encodeurl", "version": "1.0.1", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.0", "license": "MIT", "description": "Encode a URL to a percent-encoded form, excluding already-encoded sequences", "is_outdated": true, "depth": 2, "children": []}, "vulnerabilities": [], "risk_score": 1.1, "risk_level": "low"}, {"package": {"name": "http-errors", "version": "1.6.2", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.1", "license": "MIT", "description": "Create HTTP error objects", "is_outdated": true, "depth": 2, "children": [{"name": "inherits", "version": "2.0.3", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.4", "license": "ISC", "description": "Browser-friendly inheritance fully compatible with standard node.js inherits()", "is_outdated": true, "depth": 3, "children": []}, {"name": "setprototypeof", "version": "1.0.3", "ecosystem": "npm", "is_direct": false, "latest_version": "1.2.0", "license": "ISC", "description": "A small polyfill for Object.setprototypeof", "is_outdated": true, "depth": 3, "children": []}]}, "vulnerabilities": [], "risk_score": 1.1, "risk_level": "low"}, {"package": {"name": "on-finished", "version": "2.3.0", "ecosystem": "npm", "is_direct": false, "latest_version": "2.4.1", "license": "MIT", "description": "Execute a callback when a request closes, finishes, or errors", "is_outdated": true, "depth": 2, "children": [{"name": "ee-first", "version": "1.1.1", "ecosystem": "npm", "is_direct": false, "latest_version": "1.1.1", "license": "MIT", "description": "return the first event in a set of ee/event pairs", "is_outdated": false, "depth": 3, "children": []}]}, "vulnerabilities": [], "risk_score": 1.1, "risk_level": "low"}, {"package": {"name": "range-parser", "version": "1.2.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.2.1", "license": "MIT", "description": "Range header field string parser", "is_outdated": true, "depth": 2, "children": []}, "vulnerabilities": [], "risk_score": 1.1, "risk_level": "low"}, {"package": {"name": "mime-types", "version": "2.1.16", "ecosystem": "npm", "is_direct": false, "latest_version": "3.0.2", "license": "MIT", "description": "The ultimate javascript content-type utility.", "is_outdated": true, "depth": 2, "children": [{"name": "mime-db", "version": "1.29.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.54.0", "license": "MIT", "description": "Media Type Database", "is_outdated": true, "depth": 3, "children": []}]}, "vulnerabilities": [], "risk_score": 1.1, "risk_level": "low"}, {"package": {"name": "negotiator", "version": "0.6.1", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.0", "license": "MIT", "description": "HTTP content negotiation", "is_outdated": true, "depth": 2, "children": []}, "vulnerabilities": [], "risk_score": 1.1, "risk_level": "low"}, {"package": {"name": "media-typer", "version": "0.3.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.1.0", "license": "MIT", "description": "Simple RFC 6838 media type parser and formatter", "is_outdated": true, "depth": 2, "children": []}, "vulnerabilities": [], "risk_score": 1.1, "risk_level": "low"}, {"package": {"name": "forwarded", "version": "0.1.2", "ecosystem": "npm", "is_direct": false, "latest_version": "0.2.0", "license": "MIT", "description": "Parse HTTP X-Forwarded-For header", "is_outdated": true, "depth": 2, "children": []}, "vulnerabilities": [], "risk_score": 1.1, "risk_level": "low"}, {"package": {"name": "ipaddr.js", "version": "1.5.2", "ecosystem": "npm", "is_direct": false, "latest_version": "2.3.0", "license": "MIT", "description": "A library for manipulating IPv4 and IPv6 addresses in JavaScript.", "is_outdated": true, "depth": 2, "children": []}, "vulnerabilities": [], "risk_score": 1.1, "risk_level": "low"}, {"package": {"name": "bytes", "version": "3.0.0", "ecosystem": "npm", "is_direct": false, "latest_version": "3.1.2", "license": "MIT", "description": "Utility to parse a string bytes to bytes and vice-versa", "is_outdated": true, "depth": 2, "children": []}, "vulnerabilities": [], "risk_score": 1.1, "risk_level": "low"}, {"package": {"name": "raw-body", "version": "2.3.2", "ecosystem": "npm", "is_direct": false, "latest_version": "3.0.2", "license": "MIT", "description": "Get and validate the raw body of a readable stream.", "is_outdated": true, "depth": 2, "children": [{"name": "unpipe", "version": "1.0.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.0", "license": "MIT", "description": "Unpipe a stream from all destinations", "is_outdated": false, "depth": 3, "children": []}, {"name": "iconv-lite", "version": "0.4.19", "ecosystem": "npm", "is_direct": false, "latest_version": "0.7.2", "license": "MIT", "description": "Convert character encodings in pure javascript.", "is_outdated": true, "depth": 3, "children": []}]}, "vulnerabilities": [], "risk_score": 1.1, "risk_level": "low"}, {"package": {"name": "content-type", "version": "1.0.4", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.5", "license": "MIT", "description": "Create and parse HTTP Content-Type header", "is_outdated": true, "depth": 2, "children": []}, "vulnerabilities": [], "risk_score": 1.1, "risk_level": "low"}, {"package": {"name": "cookie", "version": "0.3.1", "ecosystem": "npm", "is_direct": false, "latest_version": "1.1.1", "license": "MIT", "description": "HTTP server cookie parsing and serialization", "is_outdated": true, "depth": 1, "children": []}, "vulnerabilities": [{"id": "GHSA-pxg6-pf52-xh8x", "source": "OSV", "summary": "cookie accepts cookie name, path, and domain with out of bounds characters", "severity": "none", "cvss_score": 0.0, "affected_versions": ">=0, <0.7.0", "fixed_version": "0.7.0", "references": ["https://github.com/jshttp/cookie/security/advisories/GHSA-pxg6-pf52-xh8x", "https://github.com/jshttp/cookie/pull/167", "https://github.com/jshttp/cookie/commit/e10042845354fea83bd8f34af72475eed1dadf5c", "https://github.com/jshttp/cookie"], "published": "2024-10-04T20:31:00Z", "cwe_ids": ["CWE-74"]}], "risk_score": 1.0, "risk_level": "low"}, {"package": {"name": "depd", "version": "1.1.1", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.0", "license": "MIT", "description": "Deprecate all the things", "is_outdated": true, "depth": 1, "children": []}, "vulnerabilities": [], "risk_score": 1.0, "risk_level": "low"}, {"package": {"name": "accepts", "version": "1.3.4", "ecosystem": "npm", "is_direct": false, "latest_version": "1.3.8", "license": "MIT", "description": "Higher-level content negotiation", "is_outdated": true, "depth": 1, "children": [{"name": "mime-types", "version": "2.1.16", "ecosystem": "npm", "is_direct": false, "latest_version": "3.0.2", "license": "MIT", "description": "The ultimate javascript content-type utility.", "is_outdated": true, "depth": 2, "children": [{"name": "mime-db", "version": "1.29.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.54.0", "license": "MIT", "description": "Media Type Database", "is_outdated": true, "depth": 3, "children": []}]}, {"name": "negotiator", "version": "0.6.1", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.0", "license": "MIT", "description": "HTTP content negotiation", "is_outdated": true, "depth": 2, "children": []}]}, "vulnerabilities": [], "risk_score": 1.0, "risk_level": "low"}, {"package": {"name": "type-is", "version": "1.6.15", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.1", "license": "MIT", "description": "Infer the content-type of a request.", "is_outdated": true, "depth": 1, "children": [{"name": "media-typer", "version": "0.3.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.1.0", "license": "MIT", "description": "Simple RFC 6838 media type parser and formatter", "is_outdated": true, "depth": 2, "children": []}]}, "vulnerabilities": [], "risk_score": 1.0, "risk_level": "low"}, {"package": {"name": "parseurl", "version": "1.3.2", "ecosystem": "npm", "is_direct": false, "latest_version": "1.3.3", "license": "MIT", "description": "parse a url with memoization", "is_outdated": true, "depth": 1, "children": []}, "vulnerabilities": [], "risk_score": 1.0, "risk_level": "low"}, {"package": {"name": "proxy-addr", "version": "2.0.2", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.7", "license": "MIT", "description": "Determine address of proxied request", "is_outdated": true, "depth": 1, "children": [{"name": "forwarded", "version": "0.1.2", "ecosystem": "npm", "is_direct": false, "latest_version": "0.2.0", "license": "MIT", "description": "Parse HTTP X-Forwarded-For header", "is_outdated": true, "depth": 2, "children": []}, {"name": "ipaddr.js", "version": "1.5.2", "ecosystem": "npm", "is_direct": false, "latest_version": "2.3.0", "license": "MIT", "description": "A library for manipulating IPv4 and IPv6 addresses in JavaScript.", "is_outdated": true, "depth": 2, "children": []}]}, "vulnerabilities": [], "risk_score": 1.0, "risk_level": "low"}, {"package": {"name": "safe-buffer", "version": "5.1.1", "ecosystem": "npm", "is_direct": false, "latest_version": "5.2.1", "license": "MIT", "description": "Safer Node.js Buffer API", "is_outdated": true, "depth": 1, "children": []}, "vulnerabilities": [], "risk_score": 1.0, "risk_level": "low"}, {"package": {"name": "finalhandler", "version": "1.1.0", "ecosystem": "npm", "is_direct": false, "latest_version": "2.1.1", "license": "MIT", "description": "Node.js final http responder", "is_outdated": true, "depth": 1, "children": []}, "vulnerabilities": [], "risk_score": 1.0, "risk_level": "low"}, {"package": {"name": "array-flatten", "version": "1.1.1", "ecosystem": "npm", "is_direct": false, "latest_version": "3.0.0", "license": "MIT", "description": "Flatten an array of nested arrays into a single flat array", "is_outdated": true, "depth": 1, "children": []}, "vulnerabilities": [], "risk_score": 1.0, "risk_level": "low"}, {"package": {"name": "cookie-signature", "version": "1.0.6", "ecosystem": "npm", "is_direct": false, "latest_version": "1.2.2", "license": "MIT", "description": "Sign and unsign cookies", "is_outdated": true, "depth": 1, "children": []}, "vulnerabilities": [], "risk_score": 1.0, "risk_level": "low"}, {"package": {"name": "merge-descriptors", "version": "1.0.1", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.0", "license": "MIT", "description": "Merge objects using descriptors", "is_outdated": true, "depth": 1, "children": []}, "vulnerabilities": [], "risk_score": 1.0, "risk_level": "low"}, {"package": {"name": "content-disposition", "version": "0.5.2", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.1", "license": "MIT", "description": "Create and parse Content-Disposition header", "is_outdated": true, "depth": 1, "children": []}, "vulnerabilities": [], "risk_score": 1.0, "risk_level": "low"}, {"package": {"name": "ee-first", "version": "1.1.1", "ecosystem": "npm", "is_direct": false, "latest_version": "1.1.1", "license": "MIT", "description": "return the first event in a set of ee/event pairs", "is_outdated": false, "depth": 3, "children": []}, "vulnerabilities": [], "risk_score": 0.4, "risk_level": "none"}, {"package": {"name": "unpipe", "version": "1.0.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.0", "license": "MIT", "description": "Unpipe a stream from all destinations", "is_outdated": false, "depth": 3, "children": []}, "vulnerabilities": [], "risk_score": 0.4, "risk_level": "none"}, {"package": {"name": "fresh", "version": "0.5.2", "ecosystem": "npm", "is_direct": false, "latest_version": "0.5.2", "license": "MIT", "description": "HTTP response freshness testing", "is_outdated": false, "depth": 2, "children": []}, "vulnerabilities": [], "risk_score": 0.3, "risk_level": "none"}, {"package": {"name": "escape-html", "version": "1.0.3", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.3", "license": "MIT", "description": "Escape string for use in HTML", "is_outdated": false, "depth": 2, "children": []}, "vulnerabilities": [], "risk_score": 0.3, "risk_level": "none"}, {"package": {"name": "etag", "version": "1.8.1", "ecosystem": "npm", "is_direct": false, "latest_version": "1.8.1", "license": "MIT", "description": "Create simple HTTP ETags", "is_outdated": false, "depth": 1, "children": []}, "vulnerabilities": [], "risk_score": 0.1, "risk_level": "none"}, {"package": {"name": "vary", "version": "1.1.2", "ecosystem": "npm", "is_direct": false, "latest_version": "1.1.2", "license": "MIT", "description": "Manipulate the HTTP Vary header", "is_outdated": false, "depth": 1, "children": []}, "vulnerabilities": [], "risk_score": 0.1, "risk_level": "none"}, {"package": {"name": "methods", "version": "1.1.2", "ecosystem": "npm", "is_direct": false, "latest_version": "1.1.2", "license": "MIT", "description": "HTTP methods that node supports", "is_outdated": false, "depth": 1, "children": []}, "vulnerabilities": [], "risk_score": 0.1, "risk_level": "none"}, {"package": {"name": "utils-merge", "version": "1.0.1", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.1", "license": "MIT", "description": "merge() utility function", "is_outdated": false, "depth": 1, "children": []}, "vulnerabilities": [], "risk_score": 0.1, "risk_level": "none"}], "dependency_tree": [{"name": "express", "version": "4.16.0", "ecosystem": "npm", "is_direct": true, "latest_version": "5.2.1", "license": "MIT", "description": "Fast, unopinionated, minimalist web framework", "is_outdated": true, "depth": 0, "children": [{"name": "qs", "version": "6.5.1", "ecosystem": "npm", "is_direct": false, "latest_version": "6.15.0", "license": "BSD-3-Clause", "description": "A querystring parser that supports nesting and arrays, with a depth limit", "is_outdated": true, "depth": 1, "children": []}, {"name": "depd", "version": "1.1.1", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.0", "license": "MIT", "description": "Deprecate all the things", "is_outdated": true, "depth": 1, "children": []}, {"name": "etag", "version": "1.8.1", "ecosystem": "npm", "is_direct": false, "latest_version": "1.8.1", "license": "MIT", "description": "Create simple HTTP ETags", "is_outdated": false, "depth": 1, "children": []}, {"name": "send", "version": "0.16.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.2.1", "license": "MIT", "description": "Better streaming static file server with Range and conditional-GET support", "is_outdated": true, "depth": 1, "children": [{"name": "ms", "version": "2.0.0", "ecosystem": "npm", "is_direct": false, "latest_version": "2.1.3", "license": "MIT", "description": "Tiny milisecond conversion utility", "is_outdated": true, "depth": 2, "children": []}, {"name": "mime", "version": "1.4.1", "ecosystem": "npm", "is_direct": false, "latest_version": "4.1.0", "license": "MIT", "description": "A comprehensive library for mime-type mapping", "is_outdated": true, "depth": 2, "children": []}, {"name": "debug", "version": "2.6.9", "ecosystem": "npm", "is_direct": false, "latest_version": "4.4.3", "license": "MIT", "description": "small debugging utility", "is_outdated": true, "depth": 2, "children": []}, {"name": "fresh", "version": "0.5.2", "ecosystem": "npm", "is_direct": false, "latest_version": "0.5.2", "license": "MIT", "description": "HTTP response freshness testing", "is_outdated": false, "depth": 2, "children": []}, {"name": "destroy", "version": "1.0.4", "ecosystem": "npm", "is_direct": false, "latest_version": "1.2.0", "license": "MIT", "description": "destroy a stream if possible", "is_outdated": true, "depth": 2, "children": []}, {"name": "statuses", "version": "1.3.1", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.2", "license": "MIT", "description": "HTTP status utility", "is_outdated": true, "depth": 2, "children": []}, {"name": "encodeurl", "version": "1.0.1", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.0", "license": "MIT", "description": "Encode a URL to a percent-encoded form, excluding already-encoded sequences", "is_outdated": true, "depth": 2, "children": []}, {"name": "escape-html", "version": "1.0.3", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.3", "license": "MIT", "description": "Escape string for use in HTML", "is_outdated": false, "depth": 2, "children": []}, {"name": "http-errors", "version": "1.6.2", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.1", "license": "MIT", "description": "Create HTTP error objects", "is_outdated": true, "depth": 2, "children": [{"name": "inherits", "version": "2.0.3", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.4", "license": "ISC", "description": "Browser-friendly inheritance fully compatible with standard node.js inherits()", "is_outdated": true, "depth": 3, "children": []}, {"name": "setprototypeof", "version": "1.0.3", "ecosystem": "npm", "is_direct": false, "latest_version": "1.2.0", "license": "ISC", "description": "A small polyfill for Object.setprototypeof", "is_outdated": true, "depth": 3, "children": []}]}, {"name": "on-finished", "version": "2.3.0", "ecosystem": "npm", "is_direct": false, "latest_version": "2.4.1", "license": "MIT", "description": "Execute a callback when a request closes, finishes, or errors", "is_outdated": true, "depth": 2, "children": [{"name": "ee-first", "version": "1.1.1", "ecosystem": "npm", "is_direct": false, "latest_version": "1.1.1", "license": "MIT", "description": "return the first event in a set of ee/event pairs", "is_outdated": false, "depth": 3, "children": []}]}, {"name": "range-parser", "version": "1.2.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.2.1", "license": "MIT", "description": "Range header field string parser", "is_outdated": true, "depth": 2, "children": []}]}, {"name": "vary", "version": "1.1.2", "ecosystem": "npm", "is_direct": false, "latest_version": "1.1.2", "license": "MIT", "description": "Manipulate the HTTP Vary header", "is_outdated": false, "depth": 1, "children": []}, {"name": "cookie", "version": "0.3.1", "ecosystem": "npm", "is_direct": false, "latest_version": "1.1.1", "license": "MIT", "description": "HTTP server cookie parsing and serialization", "is_outdated": true, "depth": 1, "children": []}, {"name": "accepts", "version": "1.3.4", "ecosystem": "npm", "is_direct": false, "latest_version": "1.3.8", "license": "MIT", "description": "Higher-level content negotiation", "is_outdated": true, "depth": 1, "children": [{"name": "mime-types", "version": "2.1.16", "ecosystem": "npm", "is_direct": false, "latest_version": "3.0.2", "license": "MIT", "description": "The ultimate javascript content-type utility.", "is_outdated": true, "depth": 2, "children": [{"name": "mime-db", "version": "1.29.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.54.0", "license": "MIT", "description": "Media Type Database", "is_outdated": true, "depth": 3, "children": []}]}, {"name": "negotiator", "version": "0.6.1", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.0", "license": "MIT", "description": "HTTP content negotiation", "is_outdated": true, "depth": 2, "children": []}]}, {"name": "methods", "version": "1.1.2", "ecosystem": "npm", "is_direct": false, "latest_version": "1.1.2", "license": "MIT", "description": "HTTP methods that node supports", "is_outdated": false, "depth": 1, "children": []}, {"name": "type-is", "version": "1.6.15", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.1", "license": "MIT", "description": "Infer the content-type of a request.", "is_outdated": true, "depth": 1, "children": [{"name": "media-typer", "version": "0.3.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.1.0", "license": "MIT", "description": "Simple RFC 6838 media type parser and formatter", "is_outdated": true, "depth": 2, "children": []}]}, {"name": "parseurl", "version": "1.3.2", "ecosystem": "npm", "is_direct": false, "latest_version": "1.3.3", "license": "MIT", "description": "parse a url with memoization", "is_outdated": true, "depth": 1, "children": []}, {"name": "proxy-addr", "version": "2.0.2", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.7", "license": "MIT", "description": "Determine address of proxied request", "is_outdated": true, "depth": 1, "children": [{"name": "forwarded", "version": "0.1.2", "ecosystem": "npm", "is_direct": false, "latest_version": "0.2.0", "license": "MIT", "description": "Parse HTTP X-Forwarded-For header", "is_outdated": true, "depth": 2, "children": []}, {"name": "ipaddr.js", "version": "1.5.2", "ecosystem": "npm", "is_direct": false, "latest_version": "2.3.0", "license": "MIT", "description": "A library for manipulating IPv4 and IPv6 addresses in JavaScript.", "is_outdated": true, "depth": 2, "children": []}]}, {"name": "body-parser", "version": "1.18.2", "ecosystem": "npm", "is_direct": false, "latest_version": "2.2.2", "license": "MIT", "description": "Node.js body parsing middleware", "is_outdated": true, "depth": 1, "children": [{"name": "bytes", "version": "3.0.0", "ecosystem": "npm", "is_direct": false, "latest_version": "3.1.2", "license": "MIT", "description": "Utility to parse a string bytes to bytes and vice-versa", "is_outdated": true, "depth": 2, "children": []}, {"name": "raw-body", "version": "2.3.2", "ecosystem": "npm", "is_direct": false, "latest_version": "3.0.2", "license": "MIT", "description": "Get and validate the raw body of a readable stream.", "is_outdated": true, "depth": 2, "children": [{"name": "unpipe", "version": "1.0.0", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.0", "license": "MIT", "description": "Unpipe a stream from all destinations", "is_outdated": false, "depth": 3, "children": []}, {"name": "iconv-lite", "version": "0.4.19", "ecosystem": "npm", "is_direct": false, "latest_version": "0.7.2", "license": "MIT", "description": "Convert character encodings in pure javascript.", "is_outdated": true, "depth": 3, "children": []}]}, {"name": "content-type", "version": "1.0.4", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.5", "license": "MIT", "description": "Create and parse HTTP Content-Type header", "is_outdated": true, "depth": 2, "children": []}]}, {"name": "safe-buffer", "version": "5.1.1", "ecosystem": "npm", "is_direct": false, "latest_version": "5.2.1", "license": "MIT", "description": "Safer Node.js Buffer API", "is_outdated": true, "depth": 1, "children": []}, {"name": "utils-merge", "version": "1.0.1", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.1", "license": "MIT", "description": "merge() utility function", "is_outdated": false, "depth": 1, "children": []}, {"name": "finalhandler", "version": "1.1.0", "ecosystem": "npm", "is_direct": false, "latest_version": "2.1.1", "license": "MIT", "description": "Node.js final http responder", "is_outdated": true, "depth": 1, "children": []}, {"name": "serve-static", "version": "1.13.0", "ecosystem": "npm", "is_direct": false, "latest_version": "2.2.1", "license": "MIT", "description": "Serve static files", "is_outdated": true, "depth": 1, "children": []}, {"name": "array-flatten", "version": "1.1.1", "ecosystem": "npm", "is_direct": false, "latest_version": "3.0.0", "license": "MIT", "description": "Flatten an array of nested arrays into a single flat array", "is_outdated": true, "depth": 1, "children": []}, {"name": "path-to-regexp", "version": "0.1.7", "ecosystem": "npm", "is_direct": false, "latest_version": "8.3.0", "license": "MIT", "description": "Express style path to RegExp utility", "is_outdated": true, "depth": 1, "children": []}, {"name": "cookie-signature", "version": "1.0.6", "ecosystem": "npm", "is_direct": false, "latest_version": "1.2.2", "license": "MIT", "description": "Sign and unsign cookies", "is_outdated": true, "depth": 1, "children": []}, {"name": "merge-descriptors", "version": "1.0.1", "ecosystem": "npm", "is_direct": false, "latest_version": "2.0.0", "license": "MIT", "description": "Merge objects using descriptors", "is_outdated": true, "depth": 1, "children": []}, {"name": "content-disposition", "version": "0.5.2", "ecosystem": "npm", "is_direct": false, "latest_version": "1.0.1", "license": "MIT", "description": "Create and parse Content-Disposition header", "is_outdated": true, "depth": 1, "children": []}]}, {"name": "lodash", "version": "4.17.15", "ecosystem": "npm", "is_direct": true, "latest_version": "4.17.23", "license": "MIT", "description": "Lodash modular utilities.", "is_outdated": true, "depth": 0, "children": []}], "generated_at": "2026-02-20 21:17:06 UTC"};

(function(){
  const D = DATA;

  document.getElementById('headerMeta').innerHTML =
    `<div>Target: <span>${escHtml(D.target_path)}</span></div>` +
    `<div>Ecosystems: <span>${D.ecosystems.join(', ') || 'N/A'}</span></div>` +
    `<div>Generated: <span>${D.generated_at || ''}</span></div>` +
    `<div>Duration: <span>${D.scan_duration}s</span></div>`;
  document.getElementById('footerTime').textContent = D.generated_at || '';

  renderRiskGauge(D);
  renderKPIs(D);
  renderSeverityBars(D);
  renderDonut(D);
  renderTree(D);
  renderTable(D);
  renderVulnCards(D);
  renderRecommendations(D);
})();

function escHtml(s){
  const d=document.createElement('div');d.textContent=s||'';return d.innerHTML;
}

function severityColor(s){
  const m={critical:'var(--critical)',high:'var(--high)',medium:'var(--medium)',low:'var(--low)'};
  return m[s]||'var(--none)';
}

function renderRiskGauge(D){
  const el=document.getElementById('riskGauge');
  const score=D.overall_risk_score;
  const level=D.overall_risk_level;
  const color=severityColor(level);
  const pct=score*10;
  const desc={critical:'Immediate remediation required. Critical vulnerabilities detected in the dependency chain.',
    high:'Significant risk present. Multiple high-severity issues found that should be addressed promptly.',
    medium:'Moderate risk level. Some known issues exist that should be reviewed during the next maintenance cycle.',
    low:'Low risk posture. Minor findings detected, mostly informational.',
    none:'Clean scan. No significant vulnerabilities or risks identified in the current dependency set.'}[level]||'Analysis complete.';

  const size=110,stroke=10,r=(size-stroke)/2,circ=2*Math.PI*r;
  el.innerHTML=`<div class="gauge-visual">
    <svg width="${size}" height="${size}" viewBox="0 0 ${size} ${size}">
      <circle cx="${size/2}" cy="${size/2}" r="${r}" fill="none" stroke="var(--border)" stroke-width="${stroke}"/>
      <circle cx="${size/2}" cy="${size/2}" r="${r}" fill="none" stroke="${color}" stroke-width="${stroke}"
        stroke-dasharray="${circ}" stroke-dashoffset="${circ-(circ*pct/100)}"
        stroke-linecap="round" transform="rotate(-90 ${size/2} ${size/2})" style="transition:stroke-dashoffset 1s ease"/>
      <text x="${size/2}" y="${size/2+2}" text-anchor="middle" dominant-baseline="middle"
        font-family="var(--font-display)" font-size="28" font-weight="700" fill="${color}">${score}</text>
      <text x="${size/2}" y="${size/2+18}" text-anchor="middle" font-family="var(--font-body)"
        font-size="9" fill="var(--text-muted)">/10</text>
    </svg></div>
    <div class="gauge-info"><h3 style="color:${color}">${level.charAt(0).toUpperCase()+level.slice(1)} Risk</h3><p>${desc}</p></div>`;
}

function renderKPIs(D){
  const el=document.getElementById('kpiRow');
  const kpis=[
    {label:'Total Dependencies',value:D.total_dependencies,sub:`${D.direct_dependencies} direct / ${D.transitive_dependencies} transitive`,cls:'neutral'},
    {label:'Vulnerabilities',value:D.total_vulnerabilities,sub:'across all packages',cls:D.total_vulnerabilities>0?'critical':'accent'},
    {label:'Critical',value:D.critical_count,cls:D.critical_count>0?'critical':'neutral'},
    {label:'High',value:D.high_count,cls:D.high_count>0?'high':'neutral'},
    {label:'Medium',value:D.medium_count,cls:D.medium_count>0?'medium':'neutral'},
    {label:'Outdated',value:D.outdated_count,sub:'packages behind latest',cls:D.outdated_count>0?'high':'accent'}
  ];
  el.innerHTML=kpis.map(k=>`<div class="kpi kpi--${k.cls}"><div class="kpi-stripe"></div><div class="kpi-label">${k.label}</div><div class="kpi-value">${k.value}</div>${k.sub?`<div class="kpi-sub">${k.sub}</div>`:''}</div>`).join('');
}

function renderSeverityBars(D){
  const el=document.getElementById('sevBars');
  const total=Math.max(D.total_vulnerabilities,1);
  const items=[
    {label:'Critical',count:D.critical_count,color:'var(--critical)'},
    {label:'High',count:D.high_count,color:'var(--high)'},
    {label:'Medium',count:D.medium_count,color:'var(--medium)'},
    {label:'Low',count:D.low_count,color:'var(--low)'}
  ];
  el.innerHTML=items.map(i=>{
    const pct=Math.max((i.count/total)*100,i.count>0?4:0);
    return `<div class="sev-row"><span class="sev-label" style="color:${i.color}">${i.label}</span><div class="sev-bar-track"><div class="sev-bar-fill" style="width:${pct}%;background:${i.color}"></div></div><span class="sev-count" style="color:${i.color}">${i.count}</span></div>`;
  }).join('');
}

function renderDonut(D){
  const el=document.getElementById('donutChart');
  const vuln=D.audits.filter(a=>a.vulnerabilities.length>0).length;
  const outdated=D.audits.filter(a=>a.package.is_outdated&&a.vulnerabilities.length===0).length;
  const clean=D.audits.length-vuln-outdated;
  const slices=[
    {label:'Vulnerable',value:vuln,color:'var(--critical)'},
    {label:'Outdated Only',value:outdated,color:'var(--high)'},
    {label:'Clean',value:clean,color:'var(--accent)'}
  ].filter(s=>s.value>0);

  const total=slices.reduce((s,x)=>s+x.value,0)||1;
  const size=170,cx=size/2,cy=size/2,r=60,sw=28;
  let cumAngle=-Math.PI/2;

  let arcs='';
  slices.forEach(s=>{
    const angle=(s.value/total)*2*Math.PI;
    const gap=slices.length>1?0.04:0;
    const startA=cumAngle+gap/2;
    const endA=cumAngle+angle-gap/2;
    const x1=cx+r*Math.cos(startA),y1=cy+r*Math.sin(startA);
    const x2=cx+r*Math.cos(endA),y2=cy+r*Math.sin(endA);
    const large=angle>Math.PI?1:0;
    arcs+=`<path d="M${x1},${y1} A${r},${r} 0 ${large} 1 ${x2},${y2}" fill="none" stroke="${s.color}" stroke-width="${sw}" stroke-linecap="butt"/>`;
    cumAngle+=angle;
  });

  const legend=slices.map(s=>`<div class="legend-item"><div class="legend-dot" style="background:${s.color}"></div>${s.label}: ${s.value}</div>`).join('');
  el.innerHTML=`<svg width="${size}" height="${size}" viewBox="0 0 ${size} ${size}">${arcs}<text x="${cx}" y="${cy-4}" text-anchor="middle" font-family="var(--font-display)" font-size="24" font-weight="700" fill="var(--text-primary)">${total}</text><text x="${cx}" y="${cy+14}" text-anchor="middle" font-family="var(--font-body)" font-size="10" fill="var(--text-muted)">packages</text></svg><div class="donut-legend">${legend}</div>`;
}

function renderTree(D){
  const container=document.getElementById('dep-tree');
  if(!D.dependency_tree||D.dependency_tree.length===0){container.innerHTML='<p style="color:var(--text-muted);font-size:.85rem;padding:20px">No dependency tree data available.</p>';return;}

  const root={name:'Project',children:D.dependency_tree.map(buildNode)};
  function buildNode(n){
    const node={name:n.name+(n.version?'@'+n.version:''),ecosystem:n.ecosystem,is_outdated:n.is_outdated};
    const audit=D.audits.find(a=>a.package.name.toLowerCase()===n.name.toLowerCase());
    node.risk=audit?audit.risk_level:'none';
    node.vulnCount=audit?audit.vulnerabilities.length:0;
    if(n.children&&n.children.length>0) node.children=n.children.map(buildNode);
    return node;
  }

  const hierarchy=d3.hierarchy(root);
  const nodeCount=hierarchy.descendants().length;
  const w=Math.max(container.clientWidth-40,600);
  const h=Math.max(nodeCount*22,300);

  const treeLayout=d3.tree().size([h,w-260]);
  treeLayout(hierarchy);

  const svg=d3.select(container).append('svg').attr('width',w).attr('height',h+40)
    .append('g').attr('transform','translate(130,20)');

  svg.selectAll('.tree-link').data(hierarchy.links()).join('path').attr('class','tree-link')
    .attr('d',d3.linkHorizontal().x(d=>d.y).y(d=>d.x));

  const nodes=svg.selectAll('.tree-node').data(hierarchy.descendants()).join('g')
    .attr('class','tree-node').attr('transform',d=>`translate(${d.y},${d.x})`);

  nodes.append('circle').attr('r',5)
    .attr('fill',d=>d.data.vulnCount>0?severityColor(d.data.risk):'var(--bg-card)')
    .attr('stroke',d=>d.data.vulnCount>0?severityColor(d.data.risk):d.data.is_outdated?'var(--high)':'var(--accent)')
    .append('title').text(d=>`${d.data.name}${d.data.vulnCount?' ('+d.data.vulnCount+' vulns)':''}`);

  nodes.append('text').attr('dy','0.35em').attr('x',d=>d.children?-10:10)
    .attr('text-anchor',d=>d.children?'end':'start').text(d=>d.data.name);
}

function renderTable(D){
  const head=document.getElementById('tableHead');
  const body=document.getElementById('tableBody');
  head.innerHTML=`<tr><th data-col="name">Package <span class="sort-arrow"></span></th><th data-col="version">Version</th><th data-col="ecosystem">Eco</th><th data-col="risk_score">Risk <span class="sort-arrow"></span></th><th data-col="risk_level">Severity</th><th>Vulnerabilities</th><th data-col="outdated">Status</th></tr>`;

  let audits=[...D.audits];
  let sortCol='risk_score',sortDir=-1,filterMode='all',searchTerm='';

  function render(){
    let filtered=audits;
    if(filterMode==='vulnerable') filtered=filtered.filter(a=>a.vulnerabilities.length>0);
    else if(filterMode==='outdated') filtered=filtered.filter(a=>a.package.is_outdated);
    else if(filterMode==='critical') filtered=filtered.filter(a=>a.risk_level==='critical');
    else if(filterMode==='high') filtered=filtered.filter(a=>a.risk_level==='high'||a.risk_level==='critical');

    if(searchTerm) filtered=filtered.filter(a=>a.package.name.toLowerCase().includes(searchTerm));

    filtered.sort((a,b)=>{
      let va,vb;
      if(sortCol==='name'){va=a.package.name.toLowerCase();vb=b.package.name.toLowerCase();return va<vb?-sortDir:va>vb?sortDir:0;}
      if(sortCol==='risk_score'){va=a.risk_score;vb=b.risk_score;}
      else if(sortCol==='outdated'){va=a.package.is_outdated?1:0;vb=b.package.is_outdated?1:0;}
      else{va=a[sortCol]||'';vb=b[sortCol]||'';}
      return (va-vb)*sortDir;
    });

    body.innerHTML=filtered.map(a=>{
      const p=a.package;
      const vulnHtml=a.vulnerabilities.length?`<ul class="vuln-list">${a.vulnerabilities.slice(0,4).map(v=>`<li><span class="vuln-id">${escHtml(v.id)}</span><span class="vuln-src">${v.source}</span></li>`).join('')}${a.vulnerabilities.length>4?`<li style="color:var(--text-muted)">+${a.vulnerabilities.length-4} more</li>`:''}</ul>`:'<span style="color:var(--text-muted);font-size:.78rem">None found</span>';
      const statusBadges=(p.is_outdated?'<span class="badge badge--outdated">Outdated</span>':'<span style="color:var(--text-muted);font-size:.78rem">Up to date</span>');
      return `<tr><td><span class="pkg-name">${escHtml(p.name)}</span></td><td><span class="pkg-ver">${escHtml(p.version)||''}</span>${p.latest_version&&p.is_outdated?` <span style="font-size:.7rem;color:var(--text-muted)"> ${escHtml(p.latest_version)}</span>`:''}</td><td><span style="font-size:.75rem;color:var(--text-muted)">${p.ecosystem}</span></td><td><span class="score-pill" style="color:${severityColor(a.risk_level)}">${a.risk_score}</span></td><td><span class="badge badge--${a.risk_level}">${a.risk_level}</span></td><td>${vulnHtml}</td><td>${statusBadges}</td></tr>`;
    }).join('');
  }

  head.querySelectorAll('th[data-col]').forEach(th=>{
    th.addEventListener('click',()=>{
      const col=th.dataset.col;
      if(sortCol===col) sortDir*=-1; else{sortCol=col;sortDir=-1;}
      head.querySelectorAll('th').forEach(t=>t.classList.remove('sorted'));
      th.classList.add('sorted');
      render();
    });
  });

  document.querySelectorAll('.filter-btn').forEach(btn=>{
    btn.addEventListener('click',()=>{
      document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      filterMode=btn.dataset.filter;
      render();
    });
  });

  document.getElementById('tableSearch').addEventListener('input',e=>{
    searchTerm=e.target.value.trim().toLowerCase();
    render();
  });

  render();
}

function renderVulnCards(D){
  const cards=document.getElementById('vulnCards');
  const allVulns=[];
  D.audits.forEach(a=>{
    a.vulnerabilities.forEach(v=>{
      allVulns.push({...v,pkg:a.package.name,pkgVer:a.package.version});
    });
  });

  if(!allVulns.length){
    document.getElementById('vulnDetailSection').style.display='none';
    return;
  }

  const sevOrder={critical:0,high:1,medium:2,low:3,none:4};
  allVulns.sort((a,b)=>(sevOrder[a.severity]||4)-(sevOrder[b.severity]||4)||b.cvss_score-a.cvss_score);

  cards.innerHTML=allVulns.slice(0,30).map(v=>{
    const refs=v.references&&v.references.length?v.references.slice(0,2).map(r=>`<a href="${escHtml(r)}" target="_blank" rel="noopener">${shortenUrl(r)}</a>`).join(' &middot; '):'';
    return `<div class="vuln-card vuln-card--${v.severity}">
      <div class="vuln-card-header">
        <span class="vuln-card-id">${escHtml(v.id)}</span>
        <span class="badge badge--${v.severity}">${v.severity}</span>
        <span class="score-pill" style="color:${severityColor(v.severity)}">${v.cvss_score>0?v.cvss_score.toFixed(1):'N/A'}</span>
        <span class="vuln-card-pkg">${escHtml(v.pkg)}@${escHtml(v.pkgVer||'*')}</span>
      </div>
      <div class="vuln-card-body">${escHtml(v.summary)}</div>
      <div class="vuln-card-meta">
        ${v.fixed_version?`<span>Fix: <strong style="color:var(--accent)">${escHtml(v.fixed_version)}</strong></span>`:''}
        ${v.published?`<span>Published: ${escHtml(v.published)}</span>`:''}
        ${v.cwe_ids&&v.cwe_ids.length?`<span>${v.cwe_ids.join(', ')}</span>`:''}
        ${refs?`<span>${refs}</span>`:''}
      </div>
    </div>`;
  }).join('');
}

function shortenUrl(u){try{return new URL(u).hostname.replace('www.','')}catch(e){return u.substring(0,40)}}

function renderRecommendations(D){
  const box=document.getElementById('recBox');
  const recs=[];

  const critPkgs=D.audits.filter(a=>a.risk_level==='critical');
  const highPkgs=D.audits.filter(a=>a.risk_level==='high');
  const outdatedPkgs=D.audits.filter(a=>a.package.is_outdated);

  if(critPkgs.length){
    recs.push({priority:'critical',text:`<strong>Immediately remediate ${critPkgs.length} critical-risk package${critPkgs.length>1?'s':''}:</strong> ${critPkgs.map(a=>a.package.name).join(', ')}. Check the fixed versions listed above and upgrade as soon as possible.`});
  }
  if(highPkgs.length){
    recs.push({priority:'high',text:`<strong>Address ${highPkgs.length} high-risk package${highPkgs.length>1?'s':''}:</strong> ${highPkgs.map(a=>a.package.name).join(', ')}. Schedule upgrades within the current development cycle.`});
  }
  if(outdatedPkgs.length){
    recs.push({priority:'medium',text:`<strong>${outdatedPkgs.length} outdated package${outdatedPkgs.length>1?'s':''}:</strong> ${outdatedPkgs.slice(0,8).map(a=>a.package.name).join(', ')}${outdatedPkgs.length>8?` and ${outdatedPkgs.length-8} more`:''} are behind their latest releases. Keeping dependencies current reduces future exposure to newly disclosed CVEs.`});
  }

  const transitive=D.audits.filter(a=>!a.package.is_direct&&a.vulnerabilities.length>0);
  if(transitive.length){
    recs.push({priority:'medium',text:`<strong>${transitive.length} vulnerable transitive dependency${transitive.length>1?'ies':'y'} found.</strong> These are pulled in by your direct dependencies. Consider overriding pinned versions or requesting upstream maintainers release patches.`});
  }

  if(D.total_vulnerabilities===0&&D.outdated_count===0){
    recs.push({priority:'none',text:'<strong>No action required.</strong> All dependencies passed vulnerability checks and appear up to date. Continue routine audits on a regular cadence.'});
  } else {
    recs.push({priority:'low',text:'<strong>Integrate this scanner into your CI/CD pipeline</strong> to catch new vulnerabilities as they are disclosed. Automated checks on every pull request prevent vulnerable packages from reaching production.'});
    recs.push({priority:'low',text:'<strong>Implement a dependency pinning strategy</strong> using lock files (package-lock.json, Pipfile.lock) to ensure reproducible builds and prevent unexpected upgrades introducing unvetted code.'});
  }

  box.innerHTML=`<h3>Action Items</h3>`+recs.map(r=>`<div class="rec-item"><div class="rec-priority" style="background:${severityColor(r.priority)}"></div><div class="rec-text">${r.text}</div></div>`).join('');
}
</script>
</body>
</html>
